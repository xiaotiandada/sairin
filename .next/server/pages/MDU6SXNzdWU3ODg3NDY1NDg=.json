{"pageProps":{"post":{"id":"MDU6SXNzdWU3ODg3NDY1NDg=","url":"https://github.com/xiaotiandada/blog/issues/39","title":"vueå¾®ä¿¡åˆ†äº«","updatedAt":"2021-01-19T06:29:54Z","createdAt":"2021-01-19T06:29:54Z","body":"2019-11-02 00:30:30\r\n\r\n[ä¸Šæ–‡ é…ç½®ç¯å¢ƒ](https://xiaotiandada.github.io/2019/10/23/%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E5%BE%AE%E4%BF%A1SDK/)\r\n\r\nè¿™ç¯‡ä¸»è¦æ˜¯åˆ†äº«vueåšå¾®ä¿¡åˆ†äº«\r\n\r\n<!-- more -->\r\n\r\nå‡è®¾æœ¬åœ°çš„å¼€å‘ç¯å¢ƒå·²ç»å‡†å¤‡å¥½äº†!!! ğŸ‘ å¹¶ä¸”ä½ æœ‰ä¸€ä¸ªå¥½çš„åŒäº‹ä¸ºä½ å†™å¥½äº†æ¥å£ğŸ˜Š\r\n\r\n\r\nnpmçš„åœ°å€\r\n\r\n[sdk](https://www.npmjs.com/package/weixin-js-sdk)\r\n[axios](https://www.npmjs.com/package/axios)\r\n\r\n```bash\r\nnpm install weixin-js-sdk #å¾®ä¿¡å®˜æ–¹js-sdk\r\n\r\nnpm install axios #åŸºäºPromiseçš„HTTPå®¢æˆ·ç«¯ï¼Œç”¨äºæµè§ˆå™¨å’Œnode.js\r\n```\r\n\r\næ–°å»ºä¸€ä¸ªjsæ–‡ä»¶(å‡å¦‚ä»–å«wechat_share.js)\r\n\r\n```js\r\nimport wx from 'weixin-js-sdk'\r\nimport axios from 'axios'\r\n\r\nexport default ({ title, desc, link, imgUrl }) => {\r\n  let defaultTitle = 'é»˜è®¤æ ‡é¢˜'\r\n  let defaultDesc = 'é»˜è®¤æè¿°'\r\n  let defaultLink = window.location.href\r\n  let defaultimgUrl ='é»˜è®¤å›¾ç‰‡'\r\n  // é€šè¿‡æ¥å£è·å–ç­¾åä¿¡æ¯, ä¼ é€’urlè¿‡å», url éœ€è¦ encodeURIComponent\r\n  axios\r\n    .get(`/xxx/sign?url=${encodeURIComponent(defaultLink)}`)\r\n    .then(res => {\r\n      if (res.status === 200 && 'å…¶ä»–åˆ¤æ–­') {\r\n        let { hash, timestamp, nonce } = res.data.data\r\n        wx.config({\r\n          debug: false, // å¼€å¯è°ƒè¯•æ¨¡å¼,è°ƒç”¨çš„æ‰€æœ‰apiçš„è¿”å›å€¼ä¼šåœ¨å®¢æˆ·ç«¯alertå‡ºæ¥ï¼Œè‹¥è¦æŸ¥çœ‹ä¼ å…¥çš„å‚æ•°ï¼Œå¯ä»¥åœ¨pcç«¯æ‰“å¼€ï¼Œå‚æ•°ä¿¡æ¯ä¼šé€šè¿‡logæ‰“å‡ºï¼Œä»…åœ¨pcç«¯æ—¶æ‰ä¼šæ‰“å°ã€‚\r\n          appId: 'xxxxxx', // å¿…å¡«ï¼Œå…¬ä¼—å·çš„å”¯ä¸€æ ‡è¯†\r\n          timestamp, // å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„æ—¶é—´æˆ³\r\n          nonceStr: nonce, // å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„éšæœºä¸²\r\n          signature: hash, // å¿…å¡«ï¼Œç­¾å\r\n          jsApiList: [\r\n            'updateAppMessageShareData',\r\n            'updateTimelineShareData',\r\n            'onMenuShareAppMessage'\r\n          ]\r\n        })\r\n        wx.error(function(res) {\r\n          console.log('wechat error', res)\r\n        })\r\n        wx.ready(function() {\r\n          wx.updateAppMessageShareData({\r\n            title: title || defaultTitle,\r\n            desc: desc || defaultDesc,\r\n            link: link || defaultLink,\r\n            imgUrl: imgUrl || defaultimgUrl,\r\n            success: function() {\r\n              console.log('wechat share success updateAppMessageShareData')\r\n            }\r\n          })\r\n          wx.updateTimelineShareData({\r\n            title: title || desc || defaultTitle,\r\n            link: link || defaultLink,\r\n            imgUrl: imgUrl || defaultimgUrl,\r\n            success: function() {\r\n              console.log('wechat share success updateTimelineShareData')\r\n            }\r\n          })\r\n          // å³å°†åºŸå¼ƒï¼Œé€‚é…ç”µè„‘ç‰ˆå¾®ä¿¡ï¼Œå‚è€ƒï¼šhttps://mp.weixin.qq.com/wiki?action=doc&id=mp1421141115#10\r\n          wx.onMenuShareAppMessage({\r\n            title: title || defaultTitle,\r\n            desc: desc || defaultDesc,\r\n            link: link || defaultLink,\r\n            imgUrl: imgUrl || defaultimgUrl,\r\n            success: function() {\r\n              console.log('wechat share success onMenuShareAppMessage')\r\n            }\r\n          })\r\n        })\r\n      }\r\n    })\r\n}\r\n```\r\n\r\nå°è£…äº†ä¸€ä¸ªç®€å•çš„æ–¹æ³•, ç”¨æˆ·åšå¾®ä¿¡åˆ†äº« æˆ‘ä»¬åªéœ€è¦è°ƒç”¨æ–¹æ³•, å¹¶ä¸”ä¼ é€’ä¿¡æ¯å³å¯, é‡Œé¢çš„æ ‡é¢˜ä¿¡æ¯å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µä¿®æ”¹!!!\r\n\r\næ¥ä¸‹æ¥åªéœ€è¦åœ¨ä½¿ç”¨çš„åœ°æ–¹è°ƒç”¨å³å¯(æˆ‘åœ¨å…¨å±€å†™äº†ä¸€ä¸ª)\r\n\r\n```js\r\n// main.js\r\nimport wechatShare from 'wechat_share'\r\nVue.prototype.$wechatShare = wechatShare\r\n\r\n// other.vue xxx used\r\n\r\nthis.$wechatShare({})\r\n```\r\n\r\nå¦‚æœæ¯ä¸ªé¡µé¢éƒ½è°ƒç”¨ä¸€æ¬¡é‚£å°±å¤ªéº»çƒ¦äº†, åˆ©ç”¨routerçš„é’©å­å‡½æ•°, ç„¶åæŠŠæ–¹æ³•æ”¾å…¥router.js é‡Œé¢, ä½¿ç”¨ router.afterEach æ–¹æ³•([å…¨å±€åç½®é’©å­](https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E5%85%A8%E5%B1%80%E5%90%8E%E7%BD%AE%E9%92%A9%E5%AD%90))\r\n\r\n```js\r\n// router.js\r\nimport wechatShare from 'wechat_share'\r\n\r\nrouter.afterEach((to, from) => {\r\n  wechatShare({})\r\n})\r\n```\r\nç„¶åæ¯ä¸ªé¡µé¢éƒ½ä¼šæ‹¥æœ‰åˆ†äº«åŠŸèƒ½(ğŸ˜„ğŸ˜„ğŸ˜„ğŸ˜„)\r\n\r\n---\r\n\r\nä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜\bâš ï¸ï¸ï¸ï¸ï¸\bâš ï¸ï¸ï¸ï¸ï¸\bâš ï¸ï¸ï¸ï¸ï¸, åˆ‡æ¢é¡µé¢ ç„¶åå»ç­¾åçš„æ—¶å€™, å¾®ä¿¡æŠ¥é”™è¯´æ˜¯æ— æ•ˆç­¾å!!!!\r\n\r\nåŸå› æ˜¯å› ä¸ºä¼ é€’çš„localhost.hrefä¸å½“å‰é¡µé¢ä¸ç¬¦åˆ!!!\r\n\r\nå› ä¸ºrouter.afterEachæ˜¯å¼‚æ­¥çš„(åˆ«äººè¿™æ ·è¯´çš„)ç„¶åéœ€è¦é€šè¿‡this.$nextTickæ¥è§£å†³(ç”¨setTimeoutä¹Ÿå¯ä»¥ ä½†æ˜¯ä¸å¤ªå¥½ ä½ æ‡‚çš„233)\r\n```js\r\n// router.js\r\nimport wechatShare from 'wechat_share'\r\nimport Vue from 'vue'\r\n\r\nrouter.afterEach((to, from) => {\r\n  Vue.nextTick(() => {\r\n    wechatShare({})\r\n  })\r\n})\r\n```\r\n\r\nåœ¨routeré‡Œé¢ä½¿ç”¨è®²this.$nextTickä¿®æ”¹ä¸ºVue.nextTick(è¿™æ ·å°±å¯ä»¥è§£å†³, router.afterEachè·å–çš„localhost.hrefä¸å½“å‰é¡µé¢ä¸ç¬¦åˆçš„é—®é¢˜\r\n\r\nç„¶åå°±æ˜¯ä¸€ä¸ªä¸ªåˆ«é¡µé¢, éœ€è¦å®šåˆ¶åŒ–å†…å®¹åˆ†äº«, è°ƒç”¨æ–¹æ³•å³å¯\r\n\r\n```js\r\n// å¼‚æ­¥\r\nasync xx() {\r\n  await xx().then(() => {\r\n      this.$wechatShare({\r\n        title,\r\n        desc,\r\n        imgUrl\r\n      })\r\n  })\r\n}\r\n\r\n// åŒæ­¥\r\nthis.$wechatShare({\r\n  title,\r\n  desc,\r\n  imgUrl\r\n})\r\n```\r\n\r\nå¦‚æœæ˜¯å¼‚æ­¥çš„åªéœ€è¦åœ¨è°ƒç”¨å®Œæ–¹æ³•ä¹‹å, è°ƒç”¨å†™å…¥å†…å®¹å³å¯(ğŸš€ğŸš€ğŸš€)\r\n\r\n---\r\n\r\nå¦‚æœæ¯ä¸ªé¡µé¢éƒ½æƒ³è®¾ç½®æ€ä¹ˆåŠ???\r\n\r\nè§£å†³æ–¹æ¡ˆ åœ¨routerçš„metaé‡Œé¢é…ç½®ä¸€äº›ç®€å•çš„ä¿¡æ¯å³å¯\r\n\r\n```js\r\n...\r\nrouter: [\r\n     {\r\n      path: '/',\r\n      name: 'index',\r\n      component: () => import(/* webpackChunkName: \"index\" */ 'index.vue'),\r\n      meta: {\r\n        title: 'xxxxxxxxxx'\r\n        ....\r\n      }\r\n    },\r\n]\r\n...\r\n\r\nrouter.afterEach((to, from) => {\r\n  Vue.nextTick(() => {\r\n    wechatShare({\r\n      title: to.meta.title\r\n    })\r\n  })\r\n})\r\n```\r\n\r\nåœ¨é’©å­å‡½æ•°afterEaché‡Œé¢è®¾ç½®é»˜è®¤çš„title: to.meta.title ğŸ‘ ğŸš€ ğŸ”¥\r\n\r\næ•ˆæœå›¾\r\n\r\n[ä½“éªŒåœ°å€](https://matataki.io/) å¾®ä¿¡æ‰“å¼€ä¼šè‡ªåŠ¨è·³è½¬çš„\r\n\r\nhttps://matataki.io/\r\n\r\n![æ•ˆæœå›¾](vueå¾®ä¿¡åˆ†äº«/1.png)\r\n\r\n","comments":{"nodes":[]},"reactionGroups":[{"content":"THUMBS_UP","reactors":{"totalCount":0}},{"content":"THUMBS_DOWN","reactors":{"totalCount":0}},{"content":"LAUGH","reactors":{"totalCount":0}},{"content":"HOORAY","reactors":{"totalCount":0}},{"content":"CONFUSED","reactors":{"totalCount":0}},{"content":"HEART","reactors":{"totalCount":0}},{"content":"ROCKET","reactors":{"totalCount":0}},{"content":"EYES","reactors":{"totalCount":0}}],"author":{"login":"xiaotiandada","url":"https://github.com/xiaotiandada","avatarUrl":"https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d&v=4"},"html":"<p>2019-11-02 00:30:30</p>\n<p><a href=\"https://xiaotiandada.github.io/2019/10/23/%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E5%BE%AE%E4%BF%A1SDK/\">ä¸Šæ–‡ é…ç½®ç¯å¢ƒ</a></p>\n<p>è¿™ç¯‡ä¸»è¦æ˜¯åˆ†äº«vueåšå¾®ä¿¡åˆ†äº«</p>\n<!-- more -->\n\n<p>å‡è®¾æœ¬åœ°çš„å¼€å‘ç¯å¢ƒå·²ç»å‡†å¤‡å¥½äº†!!! ğŸ‘ å¹¶ä¸”ä½ æœ‰ä¸€ä¸ªå¥½çš„åŒäº‹ä¸ºä½ å†™å¥½äº†æ¥å£ğŸ˜Š</p>\n<p>npmçš„åœ°å€</p>\n<p><a href=\"https://www.npmjs.com/package/weixin-js-sdk\">sdk</a>\n<a href=\"https://www.npmjs.com/package/axios\">axios</a></p>\n<pre class=\"language-bash\"><code class=\"language-bash\">npm install weixin-js-sdk #å¾®ä¿¡å®˜æ–¹js-sdk\n\nnpm install axios #åŸºäºPromiseçš„HTTPå®¢æˆ·ç«¯ï¼Œç”¨äºæµè§ˆå™¨å’Œnode.js</code></pre><p>æ–°å»ºä¸€ä¸ªjsæ–‡ä»¶(å‡å¦‚ä»–å«wechat_share.js)</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> wx <span class=\"token keyword\">from</span> <span class=\"token string\">'weixin-js-sdk'</span>\n<span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> title<span class=\"token punctuation\">,</span> desc<span class=\"token punctuation\">,</span> link<span class=\"token punctuation\">,</span> imgUrl <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> defaultTitle <span class=\"token operator\">=</span> <span class=\"token string\">'é»˜è®¤æ ‡é¢˜'</span>\n  <span class=\"token keyword\">let</span> defaultDesc <span class=\"token operator\">=</span> <span class=\"token string\">'é»˜è®¤æè¿°'</span>\n  <span class=\"token keyword\">let</span> defaultLink <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href\n  <span class=\"token keyword\">let</span> defaultimgUrl <span class=\"token operator\">=</span><span class=\"token string\">'é»˜è®¤å›¾ç‰‡'</span>\n  <span class=\"token comment\">// é€šè¿‡æ¥å£è·å–ç­¾åä¿¡æ¯, ä¼ é€’urlè¿‡å», url éœ€è¦ encodeURIComponent</span>\n  axios\n    <span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/xxx/sign?url=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>defaultLink<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>status <span class=\"token operator\">===</span> <span class=\"token number\">200</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">'å…¶ä»–åˆ¤æ–­'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> <span class=\"token punctuation\">{</span> hash<span class=\"token punctuation\">,</span> timestamp<span class=\"token punctuation\">,</span> nonce <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> res<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>data\n        wx<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">debug</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// å¼€å¯è°ƒè¯•æ¨¡å¼,è°ƒç”¨çš„æ‰€æœ‰apiçš„è¿”å›å€¼ä¼šåœ¨å®¢æˆ·ç«¯alertå‡ºæ¥ï¼Œè‹¥è¦æŸ¥çœ‹ä¼ å…¥çš„å‚æ•°ï¼Œå¯ä»¥åœ¨pcç«¯æ‰“å¼€ï¼Œå‚æ•°ä¿¡æ¯ä¼šé€šè¿‡logæ‰“å‡ºï¼Œä»…åœ¨pcç«¯æ—¶æ‰ä¼šæ‰“å°ã€‚</span>\n          <span class=\"token literal-property property\">appId</span><span class=\"token operator\">:</span> <span class=\"token string\">'xxxxxx'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// å¿…å¡«ï¼Œå…¬ä¼—å·çš„å”¯ä¸€æ ‡è¯†</span>\n          timestamp<span class=\"token punctuation\">,</span> <span class=\"token comment\">// å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„æ—¶é—´æˆ³</span>\n          <span class=\"token literal-property property\">nonceStr</span><span class=\"token operator\">:</span> nonce<span class=\"token punctuation\">,</span> <span class=\"token comment\">// å¿…å¡«ï¼Œç”Ÿæˆç­¾åçš„éšæœºä¸²</span>\n          <span class=\"token literal-property property\">signature</span><span class=\"token operator\">:</span> hash<span class=\"token punctuation\">,</span> <span class=\"token comment\">// å¿…å¡«ï¼Œç­¾å</span>\n          <span class=\"token literal-property property\">jsApiList</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">'updateAppMessageShareData'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">'updateTimelineShareData'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">'onMenuShareAppMessage'</span>\n          <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        wx<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wechat error'</span><span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        wx<span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          wx<span class=\"token punctuation\">.</span><span class=\"token function\">updateAppMessageShareData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> title <span class=\"token operator\">||</span> defaultTitle<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">desc</span><span class=\"token operator\">:</span> desc <span class=\"token operator\">||</span> defaultDesc<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">link</span><span class=\"token operator\">:</span> link <span class=\"token operator\">||</span> defaultLink<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">imgUrl</span><span class=\"token operator\">:</span> imgUrl <span class=\"token operator\">||</span> defaultimgUrl<span class=\"token punctuation\">,</span>\n            <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wechat share success updateAppMessageShareData'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          wx<span class=\"token punctuation\">.</span><span class=\"token function\">updateTimelineShareData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> title <span class=\"token operator\">||</span> desc <span class=\"token operator\">||</span> defaultTitle<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">link</span><span class=\"token operator\">:</span> link <span class=\"token operator\">||</span> defaultLink<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">imgUrl</span><span class=\"token operator\">:</span> imgUrl <span class=\"token operator\">||</span> defaultimgUrl<span class=\"token punctuation\">,</span>\n            <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wechat share success updateTimelineShareData'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token comment\">// å³å°†åºŸå¼ƒï¼Œé€‚é…ç”µè„‘ç‰ˆå¾®ä¿¡ï¼Œå‚è€ƒï¼šhttps://mp.weixin.qq.com/wiki?action=doc&amp;id=mp1421141115#10</span>\n          wx<span class=\"token punctuation\">.</span><span class=\"token function\">onMenuShareAppMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> title <span class=\"token operator\">||</span> defaultTitle<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">desc</span><span class=\"token operator\">:</span> desc <span class=\"token operator\">||</span> defaultDesc<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">link</span><span class=\"token operator\">:</span> link <span class=\"token operator\">||</span> defaultLink<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">imgUrl</span><span class=\"token operator\">:</span> imgUrl <span class=\"token operator\">||</span> defaultimgUrl<span class=\"token punctuation\">,</span>\n            <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wechat share success onMenuShareAppMessage'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre><p>å°è£…äº†ä¸€ä¸ªç®€å•çš„æ–¹æ³•, ç”¨æˆ·åšå¾®ä¿¡åˆ†äº« æˆ‘ä»¬åªéœ€è¦è°ƒç”¨æ–¹æ³•, å¹¶ä¸”ä¼ é€’ä¿¡æ¯å³å¯, é‡Œé¢çš„æ ‡é¢˜ä¿¡æ¯å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µä¿®æ”¹!!!</p>\n<p>æ¥ä¸‹æ¥åªéœ€è¦åœ¨ä½¿ç”¨çš„åœ°æ–¹è°ƒç”¨å³å¯(æˆ‘åœ¨å…¨å±€å†™äº†ä¸€ä¸ª)</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// main.js</span>\n<span class=\"token keyword\">import</span> wechatShare <span class=\"token keyword\">from</span> <span class=\"token string\">'wechat_share'</span>\n<span class=\"token class-name\">Vue</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>$wechatShare <span class=\"token operator\">=</span> wechatShare\n\n<span class=\"token comment\">// other.vue xxx used</span>\n\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">$wechatShare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre><p>å¦‚æœæ¯ä¸ªé¡µé¢éƒ½è°ƒç”¨ä¸€æ¬¡é‚£å°±å¤ªéº»çƒ¦äº†, åˆ©ç”¨routerçš„é’©å­å‡½æ•°, ç„¶åæŠŠæ–¹æ³•æ”¾å…¥router.js é‡Œé¢, ä½¿ç”¨ router.afterEach æ–¹æ³•(<a href=\"https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E5%85%A8%E5%B1%80%E5%90%8E%E7%BD%AE%E9%92%A9%E5%AD%90\">å…¨å±€åç½®é’©å­</a>)</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// router.js</span>\n<span class=\"token keyword\">import</span> wechatShare <span class=\"token keyword\">from</span> <span class=\"token string\">'wechat_share'</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> <span class=\"token keyword\">from</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">wechatShare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre><p>ç„¶åæ¯ä¸ªé¡µé¢éƒ½ä¼šæ‹¥æœ‰åˆ†äº«åŠŸèƒ½(ğŸ˜„ğŸ˜„ğŸ˜„ğŸ˜„)</p>\n<hr>\n<p>ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜\bâš ï¸ï¸ï¸ï¸ï¸\bâš ï¸ï¸ï¸ï¸ï¸\bâš ï¸ï¸ï¸ï¸ï¸, åˆ‡æ¢é¡µé¢ ç„¶åå»ç­¾åçš„æ—¶å€™, å¾®ä¿¡æŠ¥é”™è¯´æ˜¯æ— æ•ˆç­¾å!!!!</p>\n<p>åŸå› æ˜¯å› ä¸ºä¼ é€’çš„localhost.hrefä¸å½“å‰é¡µé¢ä¸ç¬¦åˆ!!!</p>\n<p>å› ä¸ºrouter.afterEachæ˜¯å¼‚æ­¥çš„(åˆ«äººè¿™æ ·è¯´çš„)ç„¶åéœ€è¦é€šè¿‡this.$nextTickæ¥è§£å†³(ç”¨setTimeoutä¹Ÿå¯ä»¥ ä½†æ˜¯ä¸å¤ªå¥½ ä½ æ‡‚çš„233)</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// router.js</span>\n<span class=\"token keyword\">import</span> wechatShare <span class=\"token keyword\">from</span> <span class=\"token string\">'wechat_share'</span>\n<span class=\"token keyword\">import</span> Vue <span class=\"token keyword\">from</span> <span class=\"token string\">'vue'</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> <span class=\"token keyword\">from</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  Vue<span class=\"token punctuation\">.</span><span class=\"token function\">nextTick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">wechatShare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre><p>åœ¨routeré‡Œé¢ä½¿ç”¨è®²this.$nextTickä¿®æ”¹ä¸ºVue.nextTick(è¿™æ ·å°±å¯ä»¥è§£å†³, router.afterEachè·å–çš„localhost.hrefä¸å½“å‰é¡µé¢ä¸ç¬¦åˆçš„é—®é¢˜</p>\n<p>ç„¶åå°±æ˜¯ä¸€ä¸ªä¸ªåˆ«é¡µé¢, éœ€è¦å®šåˆ¶åŒ–å†…å®¹åˆ†äº«, è°ƒç”¨æ–¹æ³•å³å¯</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// å¼‚æ­¥</span>\n<span class=\"token keyword\">async</span> <span class=\"token function\">xx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">xx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">$wechatShare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        title<span class=\"token punctuation\">,</span>\n        desc<span class=\"token punctuation\">,</span>\n        imgUrl\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// åŒæ­¥</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">$wechatShare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  title<span class=\"token punctuation\">,</span>\n  desc<span class=\"token punctuation\">,</span>\n  imgUrl\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre><p>å¦‚æœæ˜¯å¼‚æ­¥çš„åªéœ€è¦åœ¨è°ƒç”¨å®Œæ–¹æ³•ä¹‹å, è°ƒç”¨å†™å…¥å†…å®¹å³å¯(ğŸš€ğŸš€ğŸš€)</p>\n<hr>\n<p>å¦‚æœæ¯ä¸ªé¡µé¢éƒ½æƒ³è®¾ç½®æ€ä¹ˆåŠ???</p>\n<p>è§£å†³æ–¹æ¡ˆ åœ¨routerçš„metaé‡Œé¢é…ç½®ä¸€äº›ç®€å•çš„ä¿¡æ¯å³å¯</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">...</span>\n<span class=\"token literal-property property\">router</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n     <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'index'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">component</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* webpackChunkName: \"index\" */</span> <span class=\"token string\">'index.vue'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">meta</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> <span class=\"token string\">'xxxxxxxxxx'</span>\n        <span class=\"token operator\">...</span><span class=\"token punctuation\">.</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n<span class=\"token operator\">...</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">afterEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> <span class=\"token keyword\">from</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  Vue<span class=\"token punctuation\">.</span><span class=\"token function\">nextTick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">wechatShare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> to<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">.</span>title\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre><p>åœ¨é’©å­å‡½æ•°afterEaché‡Œé¢è®¾ç½®é»˜è®¤çš„title: to.meta.title ğŸ‘ ğŸš€ ğŸ”¥</p>\n<p>æ•ˆæœå›¾</p>\n<p><a href=\"https://matataki.io/\">ä½“éªŒåœ°å€</a> å¾®ä¿¡æ‰“å¼€ä¼šè‡ªåŠ¨è·³è½¬çš„</p>\n<p><a href=\"https://matataki.io/\">https://matataki.io/</a></p>\n<p><img src=\"vue%E5%BE%AE%E4%BF%A1%E5%88%86%E4%BA%AB/1.png\" alt=\"æ•ˆæœå›¾\"></p>\n","attributes":{}},"themeConfig":{"title":"Blog(issues)","links":[{"title":"GitHub","url":"https://github.com/xiaotiandada/blog"},{"title":"Twitter","url":"https://twitter.com/XiaoTianIsMe"}]}},"__N_SSG":true}