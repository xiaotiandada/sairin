<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>vue微信分享 - Blog(issues)</title><meta property="og:type" content="artical"/><meta property="og:title" content="vue微信分享"/><meta property="og:image" content="
        https://og-image.vercel.app/vue微信分享.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-black.svg
      "/><meta property="article:published_time" content="2021-01-19T06:29:54Z"/><meta property="article:author" content="xiaotiandada"/><meta name="twitter:card" content="vue微信分享"/><meta name="twitter:title" content="vue微信分享"/><meta name="twitter:image" content="
        https://og-image.vercel.app/vue微信分享.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-black.svg
      "/><meta name="next-head-count" content="4"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&amp;display=swap" rel="stylesheet"/><link rel="preload" href="/_next/static/css/b78bfc7021c6877d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b78bfc7021c6877d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-2190439a97dca295.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2aac380799256b7f.js" defer=""></script><script src="/_next/static/chunks/pages/%5B...path%5D-e0b96643230aac68.js" defer=""></script><script src="/_next/static/YPEk3V-eoVeml18YoUSCM/_buildManifest.js" defer=""></script><script src="/_next/static/YPEk3V-eoVeml18YoUSCM/_ssgManifest.js" defer=""></script><script src="/_next/static/YPEk3V-eoVeml18YoUSCM/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div><div class="container mx-auto mt-24 max-w-2xl px-4 sm:px-0"><div><div class="flex my-8 font-bold"><a href="/">Blog(issues)</a></div></div><div class="mb-8"><div class="text-3xl font-medium">vue微信分享</div><div class="flex mt-4 items-center gap-2"><img class="w-8 h-8 rounded-full" src="https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d&amp;v=4"/><a target="_blank" href="https://github.com/xiaotiandada">xiaotiandada</a><a class="underline text-sm" target="_blank" href="https://github.com/xiaotiandada/blog/issues/39">View on GitHub</a></div><div class="my-8"><div class="flex gap-4 flex-wrap"></div></div></div><div class="post-body"><p>2019-11-02 00:30:30</p>
<p><a href="https://xiaotiandada.github.io/2019/10/23/%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E5%BE%AE%E4%BF%A1SDK/">上文 配置环境</a></p>
<p>这篇主要是分享vue做微信分享</p>
<!-- more -->

<p>假设本地的开发环境已经准备好了!!! 👍 并且你有一个好的同事为你写好了接口😊</p>
<p>npm的地址</p>
<p><a href="https://www.npmjs.com/package/weixin-js-sdk">sdk</a>
<a href="https://www.npmjs.com/package/axios">axios</a></p>
<pre class="language-bash"><code class="language-bash">npm install weixin-js-sdk #微信官方js-sdk

npm install axios #基于Promise的HTTP客户端，用于浏览器和node.js</code></pre><p>新建一个js文件(假如他叫wechat_share.js)</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">import</span> wx <span class="token keyword">from</span> <span class="token string">'weixin-js-sdk'</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> title<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> link<span class="token punctuation">,</span> imgUrl <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> defaultTitle <span class="token operator">=</span> <span class="token string">'默认标题'</span>
  <span class="token keyword">let</span> defaultDesc <span class="token operator">=</span> <span class="token string">'默认描述'</span>
  <span class="token keyword">let</span> defaultLink <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href
  <span class="token keyword">let</span> defaultimgUrl <span class="token operator">=</span><span class="token string">'默认图片'</span>
  <span class="token comment">// 通过接口获取签名信息, 传递url过去, url 需要 encodeURIComponent</span>
  axios
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/xxx/sign?url=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>defaultLink<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> <span class="token string">'其他判断'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span> hash<span class="token punctuation">,</span> timestamp<span class="token punctuation">,</span> nonce <span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data
        wx<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">debug</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。</span>
          <span class="token literal-property property">appId</span><span class="token operator">:</span> <span class="token string">'xxxxxx'</span><span class="token punctuation">,</span> <span class="token comment">// 必填，公众号的唯一标识</span>
          timestamp<span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的时间戳</span>
          <span class="token literal-property property">nonceStr</span><span class="token operator">:</span> nonce<span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的随机串</span>
          <span class="token literal-property property">signature</span><span class="token operator">:</span> hash<span class="token punctuation">,</span> <span class="token comment">// 必填，签名</span>
          <span class="token literal-property property">jsApiList</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'updateAppMessageShareData'</span><span class="token punctuation">,</span>
            <span class="token string">'updateTimelineShareData'</span><span class="token punctuation">,</span>
            <span class="token string">'onMenuShareAppMessage'</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        wx<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'wechat error'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        wx<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          wx<span class="token punctuation">.</span><span class="token function">updateAppMessageShareData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> title <span class="token operator">||</span> defaultTitle<span class="token punctuation">,</span>
            <span class="token literal-property property">desc</span><span class="token operator">:</span> desc <span class="token operator">||</span> defaultDesc<span class="token punctuation">,</span>
            <span class="token literal-property property">link</span><span class="token operator">:</span> link <span class="token operator">||</span> defaultLink<span class="token punctuation">,</span>
            <span class="token literal-property property">imgUrl</span><span class="token operator">:</span> imgUrl <span class="token operator">||</span> defaultimgUrl<span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'wechat share success updateAppMessageShareData'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          wx<span class="token punctuation">.</span><span class="token function">updateTimelineShareData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> title <span class="token operator">||</span> desc <span class="token operator">||</span> defaultTitle<span class="token punctuation">,</span>
            <span class="token literal-property property">link</span><span class="token operator">:</span> link <span class="token operator">||</span> defaultLink<span class="token punctuation">,</span>
            <span class="token literal-property property">imgUrl</span><span class="token operator">:</span> imgUrl <span class="token operator">||</span> defaultimgUrl<span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'wechat share success updateTimelineShareData'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token comment">// 即将废弃，适配电脑版微信，参考：https://mp.weixin.qq.com/wiki?action=doc&amp;id=mp1421141115#10</span>
          wx<span class="token punctuation">.</span><span class="token function">onMenuShareAppMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> title <span class="token operator">||</span> defaultTitle<span class="token punctuation">,</span>
            <span class="token literal-property property">desc</span><span class="token operator">:</span> desc <span class="token operator">||</span> defaultDesc<span class="token punctuation">,</span>
            <span class="token literal-property property">link</span><span class="token operator">:</span> link <span class="token operator">||</span> defaultLink<span class="token punctuation">,</span>
            <span class="token literal-property property">imgUrl</span><span class="token operator">:</span> imgUrl <span class="token operator">||</span> defaultimgUrl<span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'wechat share success onMenuShareAppMessage'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><p>封装了一个简单的方法, 用户做微信分享 我们只需要调用方法, 并且传递信息即可, 里面的标题信息可以根据自己的实际情况修改!!!</p>
<p>接下来只需要在使用的地方调用即可(我在全局写了一个)</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// main.js</span>
<span class="token keyword">import</span> wechatShare <span class="token keyword">from</span> <span class="token string">'wechat_share'</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$wechatShare <span class="token operator">=</span> wechatShare

<span class="token comment">// other.vue xxx used</span>

<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$wechatShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>如果每个页面都调用一次那就太麻烦了, 利用router的钩子函数, 然后把方法放入router.js 里面, 使用 router.afterEach 方法(<a href="https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E5%85%A8%E5%B1%80%E5%90%8E%E7%BD%AE%E9%92%A9%E5%AD%90">全局后置钩子</a>)</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// router.js</span>
<span class="token keyword">import</span> wechatShare <span class="token keyword">from</span> <span class="token string">'wechat_share'</span>

router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">wechatShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>然后每个页面都会拥有分享功能(😄😄😄😄)</p>
<hr>
<p>但是这里有一个问题⚠️️️️️⚠️️️️️⚠️️️️️, 切换页面 然后去签名的时候, 微信报错说是无效签名!!!!</p>
<p>原因是因为传递的localhost.href与当前页面不符合!!!</p>
<p>因为router.afterEach是异步的(别人这样说的)然后需要通过this.$nextTick来解决(用setTimeout也可以 但是不太好 你懂的233)</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// router.js</span>
<span class="token keyword">import</span> wechatShare <span class="token keyword">from</span> <span class="token string">'wechat_share'</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>

router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">wechatShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>在router里面使用讲this.$nextTick修改为Vue.nextTick(这样就可以解决, router.afterEach获取的localhost.href与当前页面不符合的问题</p>
<p>然后就是一个个别页面, 需要定制化内容分享, 调用方法即可</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// 异步</span>
<span class="token keyword">async</span> <span class="token function">xx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">xx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$wechatShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token punctuation">,</span>
        desc<span class="token punctuation">,</span>
        imgUrl
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 同步</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$wechatShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token punctuation">,</span>
  desc<span class="token punctuation">,</span>
  imgUrl
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>如果是异步的只需要在调用完方法之后, 调用写入内容即可(🚀🚀🚀)</p>
<hr>
<p>如果每个页面都想设置怎么办???</p>
<p>解决方案 在router的meta里面配置一些简单的信息即可</p>
<pre class="language-js"><code class="language-js"><span class="token operator">...</span>
<span class="token literal-property property">router</span><span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'index'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: "index" */</span> <span class="token string">'index.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'xxxxxxxxxx'</span>
        <span class="token operator">...</span><span class="token punctuation">.</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token operator">...</span>

router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">wechatShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>title
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>在钩子函数afterEach里面设置默认的title: to.meta.title 👍 🚀 🔥</p>
<p>效果图</p>
<p><a href="https://matataki.io/">体验地址</a> 微信打开会自动跳转的</p>
<p><a href="https://matataki.io/">https://matataki.io/</a></p>
<p><img src="vue%E5%BE%AE%E4%BF%A1%E5%88%86%E4%BA%AB/1.png" alt="效果图"></p>
</div><hr class="my-12"/><div class="font-sans"><div class="mb-12"><a target="_blank" href="https://github.com/xiaotiandada/blog/issues/39" class="font-medium border border-gray-700 hover:bg-gray-700 hover:text-gray-100 transition-all text-gray-700 text-sm rounded px-4 py-2">Add comment</a></div></div><div class="my-12"><div class="text-sm">Powered by <a class="underline" target="_blank" href="https://github.com/djyde/sairin">Sairin</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"MDU6SXNzdWU3ODg3NDY1NDg=","url":"https://github.com/xiaotiandada/blog/issues/39","title":"vue微信分享","updatedAt":"2021-01-19T06:29:54Z","createdAt":"2021-01-19T06:29:54Z","body":"2019-11-02 00:30:30\r\n\r\n[上文 配置环境](https://xiaotiandada.github.io/2019/10/23/%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E5%BE%AE%E4%BF%A1SDK/)\r\n\r\n这篇主要是分享vue做微信分享\r\n\r\n\u003c!-- more --\u003e\r\n\r\n假设本地的开发环境已经准备好了!!! 👍 并且你有一个好的同事为你写好了接口😊\r\n\r\n\r\nnpm的地址\r\n\r\n[sdk](https://www.npmjs.com/package/weixin-js-sdk)\r\n[axios](https://www.npmjs.com/package/axios)\r\n\r\n```bash\r\nnpm install weixin-js-sdk #微信官方js-sdk\r\n\r\nnpm install axios #基于Promise的HTTP客户端，用于浏览器和node.js\r\n```\r\n\r\n新建一个js文件(假如他叫wechat_share.js)\r\n\r\n```js\r\nimport wx from 'weixin-js-sdk'\r\nimport axios from 'axios'\r\n\r\nexport default ({ title, desc, link, imgUrl }) =\u003e {\r\n  let defaultTitle = '默认标题'\r\n  let defaultDesc = '默认描述'\r\n  let defaultLink = window.location.href\r\n  let defaultimgUrl ='默认图片'\r\n  // 通过接口获取签名信息, 传递url过去, url 需要 encodeURIComponent\r\n  axios\r\n    .get(`/xxx/sign?url=${encodeURIComponent(defaultLink)}`)\r\n    .then(res =\u003e {\r\n      if (res.status === 200 \u0026\u0026 '其他判断') {\r\n        let { hash, timestamp, nonce } = res.data.data\r\n        wx.config({\r\n          debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\r\n          appId: 'xxxxxx', // 必填，公众号的唯一标识\r\n          timestamp, // 必填，生成签名的时间戳\r\n          nonceStr: nonce, // 必填，生成签名的随机串\r\n          signature: hash, // 必填，签名\r\n          jsApiList: [\r\n            'updateAppMessageShareData',\r\n            'updateTimelineShareData',\r\n            'onMenuShareAppMessage'\r\n          ]\r\n        })\r\n        wx.error(function(res) {\r\n          console.log('wechat error', res)\r\n        })\r\n        wx.ready(function() {\r\n          wx.updateAppMessageShareData({\r\n            title: title || defaultTitle,\r\n            desc: desc || defaultDesc,\r\n            link: link || defaultLink,\r\n            imgUrl: imgUrl || defaultimgUrl,\r\n            success: function() {\r\n              console.log('wechat share success updateAppMessageShareData')\r\n            }\r\n          })\r\n          wx.updateTimelineShareData({\r\n            title: title || desc || defaultTitle,\r\n            link: link || defaultLink,\r\n            imgUrl: imgUrl || defaultimgUrl,\r\n            success: function() {\r\n              console.log('wechat share success updateTimelineShareData')\r\n            }\r\n          })\r\n          // 即将废弃，适配电脑版微信，参考：https://mp.weixin.qq.com/wiki?action=doc\u0026id=mp1421141115#10\r\n          wx.onMenuShareAppMessage({\r\n            title: title || defaultTitle,\r\n            desc: desc || defaultDesc,\r\n            link: link || defaultLink,\r\n            imgUrl: imgUrl || defaultimgUrl,\r\n            success: function() {\r\n              console.log('wechat share success onMenuShareAppMessage')\r\n            }\r\n          })\r\n        })\r\n      }\r\n    })\r\n}\r\n```\r\n\r\n封装了一个简单的方法, 用户做微信分享 我们只需要调用方法, 并且传递信息即可, 里面的标题信息可以根据自己的实际情况修改!!!\r\n\r\n接下来只需要在使用的地方调用即可(我在全局写了一个)\r\n\r\n```js\r\n// main.js\r\nimport wechatShare from 'wechat_share'\r\nVue.prototype.$wechatShare = wechatShare\r\n\r\n// other.vue xxx used\r\n\r\nthis.$wechatShare({})\r\n```\r\n\r\n如果每个页面都调用一次那就太麻烦了, 利用router的钩子函数, 然后把方法放入router.js 里面, 使用 router.afterEach 方法([全局后置钩子](https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E5%85%A8%E5%B1%80%E5%90%8E%E7%BD%AE%E9%92%A9%E5%AD%90))\r\n\r\n```js\r\n// router.js\r\nimport wechatShare from 'wechat_share'\r\n\r\nrouter.afterEach((to, from) =\u003e {\r\n  wechatShare({})\r\n})\r\n```\r\n然后每个页面都会拥有分享功能(😄😄😄😄)\r\n\r\n---\r\n\r\n但是这里有一个问题\b⚠️️️️️\b⚠️️️️️\b⚠️️️️️, 切换页面 然后去签名的时候, 微信报错说是无效签名!!!!\r\n\r\n原因是因为传递的localhost.href与当前页面不符合!!!\r\n\r\n因为router.afterEach是异步的(别人这样说的)然后需要通过this.$nextTick来解决(用setTimeout也可以 但是不太好 你懂的233)\r\n```js\r\n// router.js\r\nimport wechatShare from 'wechat_share'\r\nimport Vue from 'vue'\r\n\r\nrouter.afterEach((to, from) =\u003e {\r\n  Vue.nextTick(() =\u003e {\r\n    wechatShare({})\r\n  })\r\n})\r\n```\r\n\r\n在router里面使用讲this.$nextTick修改为Vue.nextTick(这样就可以解决, router.afterEach获取的localhost.href与当前页面不符合的问题\r\n\r\n然后就是一个个别页面, 需要定制化内容分享, 调用方法即可\r\n\r\n```js\r\n// 异步\r\nasync xx() {\r\n  await xx().then(() =\u003e {\r\n      this.$wechatShare({\r\n        title,\r\n        desc,\r\n        imgUrl\r\n      })\r\n  })\r\n}\r\n\r\n// 同步\r\nthis.$wechatShare({\r\n  title,\r\n  desc,\r\n  imgUrl\r\n})\r\n```\r\n\r\n如果是异步的只需要在调用完方法之后, 调用写入内容即可(🚀🚀🚀)\r\n\r\n---\r\n\r\n如果每个页面都想设置怎么办???\r\n\r\n解决方案 在router的meta里面配置一些简单的信息即可\r\n\r\n```js\r\n...\r\nrouter: [\r\n     {\r\n      path: '/',\r\n      name: 'index',\r\n      component: () =\u003e import(/* webpackChunkName: \"index\" */ 'index.vue'),\r\n      meta: {\r\n        title: 'xxxxxxxxxx'\r\n        ....\r\n      }\r\n    },\r\n]\r\n...\r\n\r\nrouter.afterEach((to, from) =\u003e {\r\n  Vue.nextTick(() =\u003e {\r\n    wechatShare({\r\n      title: to.meta.title\r\n    })\r\n  })\r\n})\r\n```\r\n\r\n在钩子函数afterEach里面设置默认的title: to.meta.title 👍 🚀 🔥\r\n\r\n效果图\r\n\r\n[体验地址](https://matataki.io/) 微信打开会自动跳转的\r\n\r\nhttps://matataki.io/\r\n\r\n![效果图](vue微信分享/1.png)\r\n\r\n","comments":{"nodes":[]},"reactionGroups":[{"content":"THUMBS_UP","reactors":{"totalCount":0}},{"content":"THUMBS_DOWN","reactors":{"totalCount":0}},{"content":"LAUGH","reactors":{"totalCount":0}},{"content":"HOORAY","reactors":{"totalCount":0}},{"content":"CONFUSED","reactors":{"totalCount":0}},{"content":"HEART","reactors":{"totalCount":0}},{"content":"ROCKET","reactors":{"totalCount":0}},{"content":"EYES","reactors":{"totalCount":0}}],"author":{"login":"xiaotiandada","url":"https://github.com/xiaotiandada","avatarUrl":"https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d\u0026v=4"},"html":"\u003cp\u003e2019-11-02 00:30:30\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://xiaotiandada.github.io/2019/10/23/%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E5%BE%AE%E4%BF%A1SDK/\"\u003e上文 配置环境\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e这篇主要是分享vue做微信分享\u003c/p\u003e\n\u003c!-- more --\u003e\n\n\u003cp\u003e假设本地的开发环境已经准备好了!!! 👍 并且你有一个好的同事为你写好了接口😊\u003c/p\u003e\n\u003cp\u003enpm的地址\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.npmjs.com/package/weixin-js-sdk\"\u003esdk\u003c/a\u003e\n\u003ca href=\"https://www.npmjs.com/package/axios\"\u003eaxios\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003enpm install weixin-js-sdk #微信官方js-sdk\n\nnpm install axios #基于Promise的HTTP客户端，用于浏览器和node.js\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e新建一个js文件(假如他叫wechat_share.js)\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e wx \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'weixin-js-sdk'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e axios \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'axios'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e title\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e desc\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e link\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e imgUrl \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e defaultTitle \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'默认标题'\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e defaultDesc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'默认描述'\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e defaultLink \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e window\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elocation\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehref\n  \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e defaultimgUrl \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'默认图片'\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// 通过接口获取签名信息, 传递url过去, url 需要 encodeURIComponent\u003c/span\u003e\n  axios\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e/xxx/sign?url=\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003e\u003cspan class=\"token function\"\u003eencodeURIComponent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edefaultLink\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eres\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eres\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estatus \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token number\"\u003e200\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"token string\"\u003e'其他判断'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e hash\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e timestamp\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e nonce \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e res\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edata\n        wx\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003econfig\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"token literal-property property\"\u003edebug\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\u003c/span\u003e\n          \u003cspan class=\"token literal-property property\"\u003eappId\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'xxxxxx'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 必填，公众号的唯一标识\u003c/span\u003e\n          timestamp\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 必填，生成签名的时间戳\u003c/span\u003e\n          \u003cspan class=\"token literal-property property\"\u003enonceStr\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e nonce\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 必填，生成签名的随机串\u003c/span\u003e\n          \u003cspan class=\"token literal-property property\"\u003esignature\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e hash\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 必填，签名\u003c/span\u003e\n          \u003cspan class=\"token literal-property property\"\u003ejsApiList\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n            \u003cspan class=\"token string\"\u003e'updateAppMessageShareData'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token string\"\u003e'updateTimelineShareData'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token string\"\u003e'onMenuShareAppMessage'\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        wx\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eres\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n          console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'wechat error'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e res\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        wx\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eready\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n          wx\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eupdateAppMessageShareData\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e title \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultTitle\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003edesc\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e desc \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultDesc\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003elink\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e link \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultLink\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003eimgUrl\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e imgUrl \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultimgUrl\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token function-variable function\"\u003esuccess\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n              console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'wechat share success updateAppMessageShareData'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n          wx\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eupdateTimelineShareData\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e title \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e desc \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultTitle\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003elink\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e link \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultLink\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003eimgUrl\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e imgUrl \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultimgUrl\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token function-variable function\"\u003esuccess\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n              console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'wechat share success updateTimelineShareData'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"token comment\"\u003e// 即将废弃，适配电脑版微信，参考：https://mp.weixin.qq.com/wiki?action=doc\u0026amp;id=mp1421141115#10\u003c/span\u003e\n          wx\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eonMenuShareAppMessage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e title \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultTitle\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003edesc\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e desc \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultDesc\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003elink\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e link \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultLink\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003eimgUrl\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e imgUrl \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e defaultimgUrl\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token function-variable function\"\u003esuccess\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n              console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'wechat share success onMenuShareAppMessage'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e封装了一个简单的方法, 用户做微信分享 我们只需要调用方法, 并且传递信息即可, 里面的标题信息可以根据自己的实际情况修改!!!\u003c/p\u003e\n\u003cp\u003e接下来只需要在使用的地方调用即可(我在全局写了一个)\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// main.js\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e wechatShare \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'wechat_share'\u003c/span\u003e\n\u003cspan class=\"token class-name\"\u003eVue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eprototype\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e$wechatShare \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e wechatShare\n\n\u003cspan class=\"token comment\"\u003e// other.vue xxx used\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003e$wechatShare\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e如果每个页面都调用一次那就太麻烦了, 利用router的钩子函数, 然后把方法放入router.js 里面, 使用 router.afterEach 方法(\u003ca href=\"https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E5%85%A8%E5%B1%80%E5%90%8E%E7%BD%AE%E9%92%A9%E5%AD%90\"\u003e全局后置钩子\u003c/a\u003e)\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// router.js\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e wechatShare \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'wechat_share'\u003c/span\u003e\n\nrouter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eafterEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eto\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003ewechatShare\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e然后每个页面都会拥有分享功能(😄😄😄😄)\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e但是这里有一个问题\b⚠️️️️️\b⚠️️️️️\b⚠️️️️️, 切换页面 然后去签名的时候, 微信报错说是无效签名!!!!\u003c/p\u003e\n\u003cp\u003e原因是因为传递的localhost.href与当前页面不符合!!!\u003c/p\u003e\n\u003cp\u003e因为router.afterEach是异步的(别人这样说的)然后需要通过this.$nextTick来解决(用setTimeout也可以 但是不太好 你懂的233)\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// router.js\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e wechatShare \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'wechat_share'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e Vue \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'vue'\u003c/span\u003e\n\nrouter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eafterEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eto\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  Vue\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003enextTick\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003ewechatShare\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在router里面使用讲this.$nextTick修改为Vue.nextTick(这样就可以解决, router.afterEach获取的localhost.href与当前页面不符合的问题\u003c/p\u003e\n\u003cp\u003e然后就是一个个别页面, 需要定制化内容分享, 调用方法即可\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// 异步\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token function\"\u003exx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003exx\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003e$wechatShare\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        title\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        desc\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        imgUrl\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// 同步\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003e$wechatShare\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  title\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  desc\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  imgUrl\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e如果是异步的只需要在调用完方法之后, 调用写入内容即可(🚀🚀🚀)\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e如果每个页面都想设置怎么办???\u003c/p\u003e\n\u003cp\u003e解决方案 在router的meta里面配置一些简单的信息即可\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token operator\"\u003e...\u003c/span\u003e\n\u003cspan class=\"token literal-property property\"\u003erouter\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n     \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003epath\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003ename\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'index'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token function-variable function\"\u003ecomponent\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token comment\"\u003e/* webpackChunkName: \"index\" */\u003c/span\u003e \u003cspan class=\"token string\"\u003e'index.vue'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003emeta\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'xxxxxxxxxx'\u003c/span\u003e\n        \u003cspan class=\"token operator\"\u003e...\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e...\u003c/span\u003e\n\nrouter\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eafterEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eto\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  Vue\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003enextTick\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003ewechatShare\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003etitle\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e to\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003emeta\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etitle\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在钩子函数afterEach里面设置默认的title: to.meta.title 👍 🚀 🔥\u003c/p\u003e\n\u003cp\u003e效果图\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://matataki.io/\"\u003e体验地址\u003c/a\u003e 微信打开会自动跳转的\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://matataki.io/\"\u003ehttps://matataki.io/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"vue%E5%BE%AE%E4%BF%A1%E5%88%86%E4%BA%AB/1.png\" alt=\"效果图\"\u003e\u003c/p\u003e\n","attributes":{}},"themeConfig":{"title":"Blog(issues)","links":[{"title":"GitHub","url":"https://github.com/xiaotiandada/blog"},{"title":"Twitter","url":"https://twitter.com/XiaoTianIsMe"}]}},"__N_SSG":true},"page":"/[...path]","query":{"path":["MDU6SXNzdWU3ODg3NDY1NDg="]},"buildId":"YPEk3V-eoVeml18YoUSCM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>