<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>tribute 实现@(艾特)功能 - Blog(issues)</title><meta property="og:type" content="artical"/><meta property="og:title" content="tribute 实现@(艾特)功能"/><meta property="og:image" content="
        https://og-image.vercel.app/tribute 实现@(艾特)功能.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-black.svg
      "/><meta property="article:published_time" content="2021-01-22T14:42:09Z"/><meta property="article:author" content="xiaotiandada"/><meta name="twitter:card" content="tribute 实现@(艾特)功能"/><meta name="twitter:title" content="tribute 实现@(艾特)功能"/><meta name="twitter:image" content="
        https://og-image.vercel.app/tribute 实现@(艾特)功能.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-black.svg
      "/><meta name="next-head-count" content="4"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&amp;display=swap" rel="stylesheet"/><link rel="preload" href="/_next/static/css/b78bfc7021c6877d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b78bfc7021c6877d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-2190439a97dca295.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2aac380799256b7f.js" defer=""></script><script src="/_next/static/chunks/pages/%5B...path%5D-e0b96643230aac68.js" defer=""></script><script src="/_next/static/YPEk3V-eoVeml18YoUSCM/_buildManifest.js" defer=""></script><script src="/_next/static/YPEk3V-eoVeml18YoUSCM/_ssgManifest.js" defer=""></script><script src="/_next/static/YPEk3V-eoVeml18YoUSCM/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div><div class="container mx-auto mt-24 max-w-2xl px-4 sm:px-0"><div><div class="flex my-8 font-bold"><a href="/">Blog(issues)</a></div></div><div class="mb-8"><div class="text-3xl font-medium">tribute 实现@(艾特)功能</div><div class="flex mt-4 items-center gap-2"><img class="w-8 h-8 rounded-full" src="https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d&amp;v=4"/><a target="_blank" href="https://github.com/xiaotiandada">xiaotiandada</a><a class="underline text-sm" target="_blank" href="https://github.com/xiaotiandada/blog/issues/66">View on GitHub</a></div><div class="my-8"><div class="flex gap-4 flex-wrap"></div></div></div><div class="post-body"><p>利用 <a href="https://github.com/zurb/tribute">https://github.com/zurb/tribute</a> 实现一个前端@的功能 大概长这样。</p>
<p><img src="https://user-images.githubusercontent.com/24250627/105509577-983a2100-5d08-11eb-87e5-7990cf20dc96.png" alt="image"></p>
<p>因为前端是Vue(Nuxt)所以用了一个别人封装好的库 <a href="https://github.com/syropian/vue-tribute">https://github.com/syropian/vue-tribute</a> </p>
<h2 id="在nuxt里面用？">在Nuxt里面用？</h2>
<blockquote>
<p>如果你不需要在Nuxt里面用就可以跳过</p>
</blockquote>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// import Tribute from 'tributejs'</span>
<span class="token keyword">let</span> Tribute

<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>client<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Tribute <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'tributejs'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> VueTribute <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'vue-tribute'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> Object<span class="token punctuation">,</span>
      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> $el <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span>default<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>elm
            <span class="token keyword">this</span><span class="token punctuation">.</span>tribute<span class="token punctuation">.</span><span class="token function">detach</span><span class="token punctuation">(</span>$el<span class="token punctuation">)</span>

            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
              $el <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span>default<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>elm
              <span class="token keyword">this</span><span class="token punctuation">.</span>tribute <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tribute</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>tribute<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>$el<span class="token punctuation">)</span>
              $el<span class="token punctuation">.</span>tributeInstance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tribute
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>client<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Tribute <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'[vue-tribute] cannot locate tributejs!'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
  
      <span class="token keyword">const</span> $el <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span>default<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>elm
  
      <span class="token keyword">this</span><span class="token punctuation">.</span>tribute <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tribute</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span>
  
      <span class="token keyword">this</span><span class="token punctuation">.</span>tribute<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>$el<span class="token punctuation">)</span>
  
      $el<span class="token punctuation">.</span>tributeInstance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tribute
  
      $el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'tribute-replaced'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">bubbles</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> $el <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span>default<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>elm

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>tribute<span class="token punctuation">.</span><span class="token function">detach</span><span class="token punctuation">(</span>$el<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>
      <span class="token string">'div'</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">staticClass</span><span class="token operator">:</span> <span class="token string">'v-tribute'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span>default
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>client<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>VueTribute<span class="token punctuation">.</span>name<span class="token punctuation">,</span> VueTribute<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> VueTribute</code></pre><p>因为Nuxt的关系 我基于源码又做了一层封装(加了一些判断而已)。</p>
<h2 id="使用">使用</h2>
<pre class="language-vue"><code class="language-vue"><client-only>
      <vue-tribute
        :options="tributeOptions"
        @tribute-no-match="noMatchFound"
        @tribute-replaced="tributeReplaced"
      >
        <div
          id="tributeShare"
          class="content-editable"
          contenteditable="true"
          placeholder="谈谈感想"
        />
      </vue-tribute>
</client-only></code></pre><h2 id="搜索用户">搜索用户</h2>
<p>最主要的是这个<strong>options</strong>配置，然后 tribute 有几种输入框，具体看Demo就知道了 这里说一下怎么搜索</p>
<pre class="language-javascript"><code class="language-javascript">      <span class="token literal-property property">tributeOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">collection</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">trigger</span><span class="token operator">:</span> <span class="token string">'@'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">values</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">query<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'query'</span><span class="token punctuation">,</span> query<span class="token punctuation">)</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
              <span class="token punctuation">}</span>

              <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">searchUser</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> cb<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">loadingItemTemplate</span><span class="token operator">:</span> <span class="token string">'&lt;div style="padding: 16px">Loading&lt;/div>'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">lookup</span><span class="token operator">:</span> <span class="token string">'key'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">fillAttr</span><span class="token operator">:</span> <span class="token string">'key'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">selectTemplate</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'item'</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span>
              <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;a
                  class="tribute-mention"
                  contenteditable="false"
                  href="javascript:;"
                  title="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>original<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"
                  data-user="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>original<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">">@</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>original<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/a></span><span class="token template-punctuation string">`</span></span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// ...</span>

    <span class="token literal-property property">searchUser</span><span class="token operator">:</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">search</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token function">cb</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">,</span></code></pre><p>搜索通过 values 定义的Func来执行 <strong>query</strong> 是输入的内容 利用cb设置数据</p>
<h2 id="设置用户显示模版">设置用户显示模版</h2>
<p>可以自定义Temp，我这里返回了一个 a Tag，默认是 span  我为了方便改成了 a。
并且设置了 data-user 自定义数据 方便后续做渲染操作。</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;a
class="tribute-mention"
contenteditable="false"
href="javascript:;"
title="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>original<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"
data-user="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>original<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">">@</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>original<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/a></span><span class="token template-punctuation string">`</span></span></code></pre><h2 id="xss过滤">Xss过滤</h2>
<p>为了避免用户插入HTML等提交，这里用 <a href="https://github.com/leizongmin/js-xss">https://github.com/leizongmin/js-xss</a> 过滤，显示的时候也需要过滤一次 避免用户通过接口提交（也可以用其他的办法）</p>
<p>这里只通过a标签 因为a标签需要做用户跳转的</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// 过滤分享内容</span>
<span class="token keyword">const</span> whiteListShare <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'contenteditable'</span><span class="token punctuation">,</span> <span class="token string">'href'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'data-user'</span><span class="token punctuation">,</span> <span class="token string">'target'</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">html<span class="token punctuation">,</span> whiteList <span class="token operator">=</span> whiteListShare</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">xss</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">whiteList</span><span class="token operator">:</span> whiteList<span class="token punctuation">,</span>
    <span class="token literal-property property">stripIgnoreTag</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">stripIgnoreTagBody</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'script'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre><h2 id="渲染">渲染</h2>
<p>因为搜索用户的时候已经做了a标签处理只需要设置属性就可以</p>
<pre class="language-javascript"><code class="language-javascript">    ele<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">,</span> <span class="token string">'xxx'</span><span class="token punctuation">)</span></code></pre><h2 id="emoji">Emoji</h2>
<p><a href="https://github.com/jm-david/emoji-mart-vue">https://github.com/jm-david/emoji-mart-vue</a> 可以考虑用这个 选择很多</p>
</div><hr class="my-12"/><div class="font-sans"><div class="mb-12"><a target="_blank" href="https://github.com/xiaotiandada/blog/issues/66" class="font-medium border border-gray-700 hover:bg-gray-700 hover:text-gray-100 transition-all text-gray-700 text-sm rounded px-4 py-2">Add comment</a></div></div><div class="my-12"><div class="text-sm">Powered by <a class="underline" target="_blank" href="https://github.com/djyde/sairin">Sairin</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"MDU6SXNzdWU3OTIwNTg3OTM=","url":"https://github.com/xiaotiandada/blog/issues/66","title":"tribute 实现@(艾特)功能","updatedAt":"2021-01-22T16:27:58Z","createdAt":"2021-01-22T14:42:09Z","body":"利用 https://github.com/zurb/tribute 实现一个前端@的功能 大概长这样。\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/24250627/105509577-983a2100-5d08-11eb-87e5-7990cf20dc96.png)\r\n\r\n\r\n因为前端是Vue(Nuxt)所以用了一个别人封装好的库 https://github.com/syropian/vue-tribute \r\n\r\n## 在Nuxt里面用？\r\n\u003e 如果你不需要在Nuxt里面用就可以跳过\r\n\r\n```javascript\r\n// import Tribute from 'tributejs'\r\nlet Tribute\r\n\r\nif (process.client) {\r\n  Tribute = require('tributejs')\r\n}\r\n\r\nconst VueTribute = {\r\n  name: 'vue-tribute',\r\n  props: {\r\n    options: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  watch: {\r\n    options: {\r\n      immediate: false,\r\n      deep: true,\r\n      handler() {\r\n        if (this.tribute) {\r\n          setTimeout(() =\u003e {\r\n            var $el = this.$slots.default[0].elm\r\n            this.tribute.detach($el)\r\n\r\n            setTimeout(() =\u003e {\r\n              $el = this.$slots.default[0].elm\r\n              this.tribute = new Tribute(this.options)\r\n              this.tribute.attach($el)\r\n              $el.tributeInstance = this.tribute\r\n            }, 0)\r\n          }, 0)\r\n        }\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    if (process.client) {\r\n      if (typeof Tribute === 'undefined') {\r\n        throw new Error('[vue-tribute] cannot locate tributejs!')\r\n      }\r\n  \r\n      const $el = this.$slots.default[0].elm\r\n  \r\n      this.tribute = new Tribute(this.options)\r\n  \r\n      this.tribute.attach($el)\r\n  \r\n      $el.tributeInstance = this.tribute\r\n  \r\n      $el.addEventListener('tribute-replaced', e =\u003e {\r\n        e.target.dispatchEvent(new Event('input', { bubbles: true }))\r\n      })\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    const $el = this.$slots.default[0].elm\r\n\r\n    if (this.tribute) {\r\n      this.tribute.detach($el)\r\n    }\r\n  },\r\n  render(h) {\r\n    return h(\r\n      'div',\r\n      {\r\n        staticClass: 'v-tribute'\r\n      },\r\n      this.$slots.default\r\n    )\r\n  }\r\n}\r\nif (process.client) {\r\n  if (typeof window !== 'undefined' \u0026\u0026 window.Vue) {\r\n    window.Vue.component(VueTribute.name, VueTribute)\r\n  }\r\n}\r\n\r\nexport default VueTribute\r\n```\r\n\r\n因为Nuxt的关系 我基于源码又做了一层封装(加了一些判断而已)。\r\n\r\n## 使用\r\n\r\n```vue\r\n\u003cclient-only\u003e\r\n      \u003cvue-tribute\r\n        :options=\"tributeOptions\"\r\n        @tribute-no-match=\"noMatchFound\"\r\n        @tribute-replaced=\"tributeReplaced\"\r\n      \u003e\r\n        \u003cdiv\r\n          id=\"tributeShare\"\r\n          class=\"content-editable\"\r\n          contenteditable=\"true\"\r\n          placeholder=\"谈谈感想\"\r\n        /\u003e\r\n      \u003c/vue-tribute\u003e\r\n\u003c/client-only\u003e\r\n```\r\n##  搜索用户\r\n最主要的是这个**options**配置，然后 tribute 有几种输入框，具体看Demo就知道了 这里说一下怎么搜索\r\n\r\n```javascript\r\n      tributeOptions: {\r\n        collection: [\r\n          {\r\n            trigger: '@',\r\n            values: (query, cb) =\u003e {\r\n              console.log('query', query)\r\n              if (!query) {\r\n                return cb([])\r\n              }\r\n\r\n              return this.searchUser(query, cb)\r\n            },\r\n            loadingItemTemplate: '\u003cdiv style=\"padding: 16px\"\u003eLoading\u003c/div\u003e',\r\n            lookup: 'key',\r\n            fillAttr: 'key',\r\n            selectTemplate: function (item) {\r\n              console.log('item', item)\r\n              return `\u003ca\r\n                  class=\"tribute-mention\"\r\n                  contenteditable=\"false\"\r\n                  href=\"javascript:;\"\r\n                  title=\"${item.original.value}\"\r\n                  data-user=\"${item.original.id}\"\u003e@${item.original.value}\u003c/a\u003e`\r\n            },\r\n          },\r\n        ],\r\n      },\r\n\r\n// ...\r\n\r\n    searchUser: debounce(async function (val, cb) {\r\n      const list = await search(params)\r\n        return cb(list)\r\n      } else {\r\n        return cb([])\r\n      }\r\n    }, 300),\r\n```\r\n\r\n搜索通过 values 定义的Func来执行 **query** 是输入的内容 利用cb设置数据\r\n\r\n## 设置用户显示模版\r\n\r\n可以自定义Temp，我这里返回了一个 a Tag，默认是 span  我为了方便改成了 a。\r\n并且设置了 data-user 自定义数据 方便后续做渲染操作。\r\n\r\n```javascript\r\nreturn `\u003ca\r\nclass=\"tribute-mention\"\r\ncontenteditable=\"false\"\r\nhref=\"javascript:;\"\r\ntitle=\"${item.original.value}\"\r\ndata-user=\"${item.original.id}\"\u003e@${item.original.value}\u003c/a\u003e`\r\n```\r\n\r\n## Xss过滤\r\n为了避免用户插入HTML等提交，这里用 https://github.com/leizongmin/js-xss 过滤，显示的时候也需要过滤一次 避免用户通过接口提交（也可以用其他的办法）\r\n\r\n这里只通过a标签 因为a标签需要做用户跳转的\r\n\r\n```javascript\r\n// 过滤分享内容\r\nconst whiteListShare = {\r\n  a: [ 'class', 'contenteditable', 'href', 'title', 'data-user', 'target' ]\r\n}\r\nexport const Fn = (html, whiteList = whiteListShare) =\u003e {\r\n  return xss(html, {\r\n    whiteList: whiteList,\r\n    stripIgnoreTag: true,\r\n    stripIgnoreTagBody: ['script']\r\n  })\r\n}\r\n```\r\n\r\n## 渲染\r\n\r\n因为搜索用户的时候已经做了a标签处理只需要设置属性就可以\r\n```javascript\r\n    ele.setAttribute('href', 'xxx')\r\n```\r\n\r\n## Emoji\r\n\r\nhttps://github.com/jm-david/emoji-mart-vue 可以考虑用这个 选择很多\r\n\r\n","comments":{"nodes":[]},"reactionGroups":[{"content":"THUMBS_UP","reactors":{"totalCount":0}},{"content":"THUMBS_DOWN","reactors":{"totalCount":0}},{"content":"LAUGH","reactors":{"totalCount":0}},{"content":"HOORAY","reactors":{"totalCount":0}},{"content":"CONFUSED","reactors":{"totalCount":0}},{"content":"HEART","reactors":{"totalCount":0}},{"content":"ROCKET","reactors":{"totalCount":0}},{"content":"EYES","reactors":{"totalCount":0}}],"author":{"login":"xiaotiandada","url":"https://github.com/xiaotiandada","avatarUrl":"https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d\u0026v=4"},"html":"\u003cp\u003e利用 \u003ca href=\"https://github.com/zurb/tribute\"\u003ehttps://github.com/zurb/tribute\u003c/a\u003e 实现一个前端@的功能 大概长这样。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://user-images.githubusercontent.com/24250627/105509577-983a2100-5d08-11eb-87e5-7990cf20dc96.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e因为前端是Vue(Nuxt)所以用了一个别人封装好的库 \u003ca href=\"https://github.com/syropian/vue-tribute\"\u003ehttps://github.com/syropian/vue-tribute\u003c/a\u003e \u003c/p\u003e\n\u003ch2 id=\"在nuxt里面用？\"\u003e在Nuxt里面用？\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e如果你不需要在Nuxt里面用就可以跳过\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// import Tribute from 'tributejs'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e Tribute\n\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eprocess\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclient\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  Tribute \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequire\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'tributejs'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e VueTribute \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ename\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'vue-tribute'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003eprops\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eoptions\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003etype\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Object\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003erequired\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ewatch\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003eoptions\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003eimmediate\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003edeep\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token function\"\u003ehandler\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"token function\"\u003esetTimeout\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e $el \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e$slots\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edefault\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eelm\n            \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edetach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e$el\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n            \u003cspan class=\"token function\"\u003esetTimeout\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n              $el \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e$slots\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edefault\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eelm\n              \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eTribute\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoptions\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eattach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e$el\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n              $el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etributeInstance \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003emounted\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eprocess\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclient\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003etypeof\u003c/span\u003e Tribute \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token string\"\u003e'undefined'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ethrow\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eError\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'[vue-tribute] cannot locate tributejs!'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e $el \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e$slots\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edefault\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eelm\n  \n      \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eTribute\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoptions\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \n      \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eattach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e$el\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \n      $el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etributeInstance \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute\n  \n      $el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'tribute-replaced'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etarget\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edispatchEvent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eEvent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'input'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ebubbles\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003ebeforeDestroy\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e $el \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e$slots\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edefault\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eelm\n\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etribute\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edetach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e$el\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003erender\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eh\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003eh\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"token string\"\u003e'div'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token literal-property property\"\u003estaticClass\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'v-tribute'\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e$slots\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edefault\n    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eprocess\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclient\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003etypeof\u003c/span\u003e window \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token string\"\u003e'undefined'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e window\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eVue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    window\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eVue\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecomponent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eVueTribute\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e VueTribute\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edefault\u003c/span\u003e VueTribute\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e因为Nuxt的关系 我基于源码又做了一层封装(加了一些判断而已)。\u003c/p\u003e\n\u003ch2 id=\"使用\"\u003e使用\u003c/h2\u003e\n\u003cpre class=\"language-vue\"\u003e\u003ccode class=\"language-vue\"\u003e\u003cclient-only\u003e\n      \u003cvue-tribute\n        :options=\"tributeOptions\"\n        @tribute-no-match=\"noMatchFound\"\n        @tribute-replaced=\"tributeReplaced\"\n      \u003e\n        \u003cdiv\n          id=\"tributeShare\"\n          class=\"content-editable\"\n          contenteditable=\"true\"\n          placeholder=\"谈谈感想\"\n        /\u003e\n      \u003c/vue-tribute\u003e\n\u003c/client-only\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"搜索用户\"\u003e搜索用户\u003c/h2\u003e\n\u003cp\u003e最主要的是这个\u003cstrong\u003eoptions\u003c/strong\u003e配置，然后 tribute 有几种输入框，具体看Demo就知道了 这里说一下怎么搜索\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e      \u003cspan class=\"token literal-property property\"\u003etributeOptions\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token literal-property property\"\u003ecollection\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003etrigger\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'@'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token function-variable function\"\u003evalues\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003equery\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cb\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n              console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'query'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e query\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003equery\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003ecb\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n              \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esearchUser\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cb\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003eloadingItemTemplate\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026lt;div style=\"padding: 16px\"\u003eLoading\u0026lt;/div\u003e'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003elookup\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'key'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token literal-property property\"\u003efillAttr\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'key'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token function-variable function\"\u003eselectTemplate\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eitem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n              console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'item'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e item\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026lt;a\n                  class=\"tribute-mention\"\n                  contenteditable=\"false\"\n                  href=\"javascript:;\"\n                  title=\"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003evalue\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\n                  data-user=\"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\u003e@\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003evalue\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026lt;/a\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// ...\u003c/span\u003e\n\n    \u003cspan class=\"token literal-property property\"\u003esearchUser\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token function\"\u003edebounce\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eval\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cb\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e list \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003esearch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eparams\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003ecb\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elist\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003ecb\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e300\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e搜索通过 values 定义的Func来执行 \u003cstrong\u003equery\u003c/strong\u003e 是输入的内容 利用cb设置数据\u003c/p\u003e\n\u003ch2 id=\"设置用户显示模版\"\u003e设置用户显示模版\u003c/h2\u003e\n\u003cp\u003e可以自定义Temp，我这里返回了一个 a Tag，默认是 span  我为了方便改成了 a。\n并且设置了 data-user 自定义数据 方便后续做渲染操作。\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026lt;a\nclass=\"tribute-mention\"\ncontenteditable=\"false\"\nhref=\"javascript:;\"\ntitle=\"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003evalue\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\ndata-user=\"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\u003e@\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoriginal\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003evalue\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026lt;/a\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"xss过滤\"\u003eXss过滤\u003c/h2\u003e\n\u003cp\u003e为了避免用户插入HTML等提交，这里用 \u003ca href=\"https://github.com/leizongmin/js-xss\"\u003ehttps://github.com/leizongmin/js-xss\u003c/a\u003e 过滤，显示的时候也需要过滤一次 避免用户通过接口提交（也可以用其他的办法）\u003c/p\u003e\n\u003cp\u003e这里只通过a标签 因为a标签需要做用户跳转的\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// 过滤分享内容\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e whiteListShare \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003ea\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e \u003cspan class=\"token string\"\u003e'class'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'contenteditable'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'href'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'title'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'data-user'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'target'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eFn\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ehtml\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e whiteList \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e whiteListShare\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003exss\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ehtml\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003ewhiteList\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e whiteList\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003estripIgnoreTag\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003estripIgnoreTagBody\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'script'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"渲染\"\u003e渲染\u003c/h2\u003e\n\u003cp\u003e因为搜索用户的时候已经做了a标签处理只需要设置属性就可以\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e    ele\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esetAttribute\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'href'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'xxx'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"emoji\"\u003eEmoji\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/jm-david/emoji-mart-vue\"\u003ehttps://github.com/jm-david/emoji-mart-vue\u003c/a\u003e 可以考虑用这个 选择很多\u003c/p\u003e\n","attributes":{}},"themeConfig":{"title":"Blog(issues)","links":[{"title":"GitHub","url":"https://github.com/xiaotiandada/blog"},{"title":"Twitter","url":"https://twitter.com/XiaoTianIsMe"}]}},"__N_SSG":true},"page":"/[...path]","query":{"path":["MDU6SXNzdWU3OTIwNTg3OTM="]},"buildId":"YPEk3V-eoVeml18YoUSCM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>