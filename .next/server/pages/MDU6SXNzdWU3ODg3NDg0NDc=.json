{"pageProps":{"post":{"id":"MDU6SXNzdWU3ODg3NDg0NDc=","url":"https://github.com/xiaotiandada/blog/issues/43","title":"compose javascript","updatedAt":"2021-01-19T06:33:34Z","createdAt":"2021-01-19T06:33:34Z","body":"2020-02-26 22:54:15\r\n\r\n在阅读某段代码的时候,了解到了``compose`` 但是似乎不止``redux`` 很多工具库都用到了这个``function``\r\n\r\n**code**\r\n\r\n```js\r\n/**\r\n * Composes single-argument functions from right to left. The rightmost\r\n * function can take multiple arguments as it provides the signature for\r\n * the resulting composite function.\r\n *\r\n * @param {...Function} funcs The functions to compose.\r\n * @returns {Function} A function obtained by composing the argument functions\r\n * from right to left. For example, compose(f, g, h) is identical to doing\r\n * (...args) => f(g(h(...args))).\r\n */\r\n\r\nexport default function compose(...funcs) {\r\n  if (funcs.length === 0) {\r\n    return arg => arg\r\n  }\r\n\r\n  if (funcs.length === 1) {\r\n    return funcs[0]\r\n  }\r\n\r\n  return funcs.reduce((a, b) => (...args) => a(b(...args)))\r\n}\r\n```\r\n\r\n以前的写法:\r\n\r\n```js\r\nfn1(fn2(fn3(fn4(fnN(...)))))\r\n```\r\n\r\n现在的写法:\r\n\r\n```js\r\ncompose(fn1, fn2, fn3, fn4, fnN)(...)\r\n```\r\n\r\n相关链接:\r\n\r\n[redux](https://github.com/reactjs/redux/blob/v3.7.2/src/compose.js)\r\n\r\n[Use function composition in JavaScript](https://www.codementor.io/@michelre/use-function-composition-in-javascript-gkmxos5mj)\r\n\r\n[redux之compose](https://segmentfault.com/a/1190000015801987)\r\n\r\n[redux compose 详解](https://cnodejs.org/topic/5995a7abee602e88524b435e)","comments":{"nodes":[]},"reactionGroups":[{"content":"THUMBS_UP","reactors":{"totalCount":0}},{"content":"THUMBS_DOWN","reactors":{"totalCount":0}},{"content":"LAUGH","reactors":{"totalCount":0}},{"content":"HOORAY","reactors":{"totalCount":0}},{"content":"CONFUSED","reactors":{"totalCount":0}},{"content":"HEART","reactors":{"totalCount":0}},{"content":"ROCKET","reactors":{"totalCount":0}},{"content":"EYES","reactors":{"totalCount":0}}],"author":{"login":"xiaotiandada","url":"https://github.com/xiaotiandada","avatarUrl":"https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d&v=4"},"html":"<p>2020-02-26 22:54:15</p>\n<p>在阅读某段代码的时候,了解到了<code>compose</code> 但是似乎不止<code>redux</code> 很多工具库都用到了这个<code>function</code></p>\n<p><strong>code</strong></p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">compose</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>funcs</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>funcs<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token parameter\">arg</span> <span class=\"token operator\">=></span> arg\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>funcs<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> funcs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> funcs<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token function\">b</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre><p>以前的写法:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">fn1</span><span class=\"token punctuation\">(</span><span class=\"token function\">fn2</span><span class=\"token punctuation\">(</span><span class=\"token function\">fn3</span><span class=\"token punctuation\">(</span><span class=\"token function\">fn4</span><span class=\"token punctuation\">(</span><span class=\"token function\">fnN</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre><p>现在的写法:</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">compose</span><span class=\"token punctuation\">(</span>fn1<span class=\"token punctuation\">,</span> fn2<span class=\"token punctuation\">,</span> fn3<span class=\"token punctuation\">,</span> fn4<span class=\"token punctuation\">,</span> fnN<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span></code></pre><p>相关链接:</p>\n<p><a href=\"https://github.com/reactjs/redux/blob/v3.7.2/src/compose.js\">redux</a></p>\n<p><a href=\"https://www.codementor.io/@michelre/use-function-composition-in-javascript-gkmxos5mj\">Use function composition in JavaScript</a></p>\n<p><a href=\"https://segmentfault.com/a/1190000015801987\">redux之compose</a></p>\n<p><a href=\"https://cnodejs.org/topic/5995a7abee602e88524b435e\">redux compose 详解</a></p>\n","attributes":{}},"themeConfig":{"title":"Blog(issues)","links":[{"title":"GitHub","url":"https://github.com/xiaotiandada/blog"},{"title":"Twitter","url":"https://twitter.com/XiaoTianIsMe"}]}},"__N_SSG":true}