{"pageProps":{"post":{"id":"I_kwDOD_pKSM5Bfdow","url":"https://github.com/xiaotiandada/blog/issues/91","title":"浏览器打开图片 URL 是显示还是下载","updatedAt":"2022-01-11T07:13:24Z","createdAt":"2022-01-11T06:55:22Z","body":"[访问存储在OSS中的资源时资源被强制下载](https://help.aliyun.com/document_detail/39545.html)\r\n\r\n[Content-Disposition](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Disposition)\r\n\r\n>## 问题原因\r\n>\r\n>访问存储在OSS的文件、图片等被强制下载的可能原因如下所示：\r\n>\r\n>- 使用OSS提供的默认域名，且没有经过其他配置。\r\n>- 对应资源的Content-Type设置错误。Content-Type如果设置为application/octet-stream也会导致强制下载，这个是二进制的下载流。\r\n>- 对应资源的Content-Disposition设置错误。Content-Disposition如果设置为attachment，就是会强制下载。\r\n>- CDN缓存了错误的Content-Type或者Content-Disposition。\r\n>- 浏览器不支持该格式资源的展示。\r\n\r\n条件问题只测试了没有域名，使用默认 OSS 提供的域名。\r\n\r\n图片1\r\n\r\nhttps://storageapi.fleek.co/andoroyur-team-bucket/metanetwork/users/metaio-storage/24jokhpxex0vg9bkcvav9xrn1.jpeg\r\n\r\n![image](https://user-images.githubusercontent.com/24250627/148896308-ab2fa536-f9fb-47f8-98c9-8b6af744cca3.png)\r\n\r\n```\r\ncontent-type: application/octet-stream\r\n```\r\n\r\n这张图片会默认下载\r\n\r\n图片2\r\n\r\nhttps://smartsignature-img.oss-cn-hongkong.aliyuncs.com/banner/2020/02/04/a60cf0aa4ec50c39196dbf97ceddbbc8.jpg\r\n\r\n![image](https://user-images.githubusercontent.com/24250627/148896449-a716187e-0c7c-4d1b-a23e-c85d6842f097.png)\r\n\r\n```\r\nContent-Type: image/jpeg\r\n```\r\n\r\n图片会默认打开预览\r\n\r\n如果 修改 HTTP 头\r\n\r\n```\r\nContent-Disposition: attachment\r\nContent-Type: image/jpeg\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/24250627/148896709-481b30f6-d521-41be-bd03-8c5179b305c4.png)\r\n\r\n这种情况会下载图片\r\n\r\n```\r\ncontent-type: application/octet-stream\r\n```\r\n\r\n这种设置会下载图片\r\n\r\n\r\n\r\n其他情况具体需要测试","comments":{"nodes":[]},"reactionGroups":[{"content":"THUMBS_UP","reactors":{"totalCount":0}},{"content":"THUMBS_DOWN","reactors":{"totalCount":0}},{"content":"LAUGH","reactors":{"totalCount":0}},{"content":"HOORAY","reactors":{"totalCount":0}},{"content":"CONFUSED","reactors":{"totalCount":0}},{"content":"HEART","reactors":{"totalCount":0}},{"content":"ROCKET","reactors":{"totalCount":0}},{"content":"EYES","reactors":{"totalCount":0}}],"author":{"login":"xiaotiandada","url":"https://github.com/xiaotiandada","avatarUrl":"https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d&v=4"},"html":"<p><a href=\"https://help.aliyun.com/document_detail/39545.html\">访问存储在OSS中的资源时资源被强制下载</a></p>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Disposition\">Content-Disposition</a></p>\n<blockquote>\n<h2 id=\"问题原因\">问题原因</h2>\n<p>访问存储在OSS的文件、图片等被强制下载的可能原因如下所示：</p>\n<ul>\n<li>使用OSS提供的默认域名，且没有经过其他配置。</li>\n<li>对应资源的Content-Type设置错误。Content-Type如果设置为application/octet-stream也会导致强制下载，这个是二进制的下载流。</li>\n<li>对应资源的Content-Disposition设置错误。Content-Disposition如果设置为attachment，就是会强制下载。</li>\n<li>CDN缓存了错误的Content-Type或者Content-Disposition。</li>\n<li>浏览器不支持该格式资源的展示。</li>\n</ul>\n</blockquote>\n<p>条件问题只测试了没有域名，使用默认 OSS 提供的域名。</p>\n<p>图片1</p>\n<p><a href=\"https://storageapi.fleek.co/andoroyur-team-bucket/metanetwork/users/metaio-storage/24jokhpxex0vg9bkcvav9xrn1.jpeg\">https://storageapi.fleek.co/andoroyur-team-bucket/metanetwork/users/metaio-storage/24jokhpxex0vg9bkcvav9xrn1.jpeg</a></p>\n<p><img src=\"https://user-images.githubusercontent.com/24250627/148896308-ab2fa536-f9fb-47f8-98c9-8b6af744cca3.png\" alt=\"image\"></p>\n<pre><code>content-type: application/octet-stream</code></pre><p>这张图片会默认下载</p>\n<p>图片2</p>\n<p><a href=\"https://smartsignature-img.oss-cn-hongkong.aliyuncs.com/banner/2020/02/04/a60cf0aa4ec50c39196dbf97ceddbbc8.jpg\">https://smartsignature-img.oss-cn-hongkong.aliyuncs.com/banner/2020/02/04/a60cf0aa4ec50c39196dbf97ceddbbc8.jpg</a></p>\n<p><img src=\"https://user-images.githubusercontent.com/24250627/148896449-a716187e-0c7c-4d1b-a23e-c85d6842f097.png\" alt=\"image\"></p>\n<pre><code>Content-Type: image/jpeg</code></pre><p>图片会默认打开预览</p>\n<p>如果 修改 HTTP 头</p>\n<pre><code>Content-Disposition: attachment\nContent-Type: image/jpeg</code></pre><p><img src=\"https://user-images.githubusercontent.com/24250627/148896709-481b30f6-d521-41be-bd03-8c5179b305c4.png\" alt=\"image\"></p>\n<p>这种情况会下载图片</p>\n<pre><code>content-type: application/octet-stream</code></pre><p>这种设置会下载图片</p>\n<p>其他情况具体需要测试</p>\n","attributes":{}},"themeConfig":{"title":"Blog(issues)","links":[{"title":"GitHub","url":"https://github.com/xiaotiandada/blog"},{"title":"Twitter","url":"https://twitter.com/XiaoTianIsMe"}]}},"__N_SSG":true}