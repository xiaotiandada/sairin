{"pageProps":{"post":{"id":"MDU6SXNzdWU3ODg3NDU5NDA=","url":"https://github.com/xiaotiandada/blog/issues/36","title":" vue自定义滚动指令","updatedAt":"2021-01-19T06:28:40Z","createdAt":"2021-01-19T06:28:40Z","body":"2019-10-21 10:48:56\r\n\r\n[教程](https://cn.vuejs.org/v2/cookbook/creating-custom-scroll-directives.html)\r\n\r\n教程写的很好, 我按照教程跑了一部分\r\n\r\n**真实的示例：为级联动画使用一个自定义滚动指令**\r\n\r\n这部分没有跑, 看了看directive里面的代码, 通过v-scroll里面的参数来进行判断的, 然后把toPath里面的参数传入进来,\r\n\r\n我根据教程学习, 然后顺便添加了一个lodash throttle 来'节流'\r\n\r\n## 创建一个vue demo\r\n```\r\n... ... 省略\r\n```\r\n\r\n新建一个directive.js\r\n\r\n```js\r\nimport Vue from 'vue'\r\nimport throttle from \"lodash/throttle\";\r\nVue.directive('scroll', {\r\n  inserted: (el, binding) => {\r\n    let f = evt => {\r\n      if (binding.value(evt, el)) {\r\n        // eslint-disable-next-line no-console\r\n        // console.log(8, binding.value(evt, el))\r\n        // remove event\r\n        window.removeEventListener('scroll', f)\r\n      }\r\n    }\r\n    // listen event\r\n    // use lodash/throttle call methods\r\n    window.addEventListener('scroll', throttle(f, 300))\r\n    // eslint-disable-next-line no-console\r\n    console.log(el, binding)\r\n  }\r\n})\r\n\r\nimport \"./directive\"; // main.js 里面 import\r\n```\r\n\r\n在组件里面\r\n\r\n```html\r\n<HelloWorld v-scroll=\"handleScroll\" class=\"box\" msg=\"Welcome to Your Vue.js App\"/>\r\n````\r\n\r\n可以是任何元素 使用 v-scroll=\"xxx\"\r\n\r\n```js\r\n// ....\r\n    handleScroll (evt, el) {\r\n      // eslint-disable-next-line no-console\r\n      console.log(19, evt, el, window.scrollY)\r\n      // judeg window.scroll, execution TweenMax function\r\n      if (window.scrollY > 50) {\r\n        TweenMax.to(el, .3, {\r\n          y: -10,\r\n          opacity: 1,\r\n          // eslint-disable-next-line no-undef\r\n          ease: Sine.easeOut\r\n        })\r\n      }\r\n      // to meet the conditions return true else return false\r\n      return window.scrollY > 100\r\n    }\r\n// ...\r\n```\r\n\r\n```css\r\n.box {\r\n  opacity: 0;\r\n  transition: 1.5s all cubic-bezier(0.39, 0.575, 0.565, 1);\r\n  /* transform: translate3d(0, 10px, 0); */\r\n}\r\n```","comments":{"nodes":[]},"reactionGroups":[{"content":"THUMBS_UP","reactors":{"totalCount":0}},{"content":"THUMBS_DOWN","reactors":{"totalCount":0}},{"content":"LAUGH","reactors":{"totalCount":0}},{"content":"HOORAY","reactors":{"totalCount":0}},{"content":"CONFUSED","reactors":{"totalCount":0}},{"content":"HEART","reactors":{"totalCount":0}},{"content":"ROCKET","reactors":{"totalCount":0}},{"content":"EYES","reactors":{"totalCount":0}}],"author":{"login":"xiaotiandada","url":"https://github.com/xiaotiandada","avatarUrl":"https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d&v=4"},"html":"<p>2019-10-21 10:48:56</p>\n<p><a href=\"https://cn.vuejs.org/v2/cookbook/creating-custom-scroll-directives.html\">教程</a></p>\n<p>教程写的很好, 我按照教程跑了一部分</p>\n<p><strong>真实的示例：为级联动画使用一个自定义滚动指令</strong></p>\n<p>这部分没有跑, 看了看directive里面的代码, 通过v-scroll里面的参数来进行判断的, 然后把toPath里面的参数传入进来,</p>\n<p>我根据教程学习, 然后顺便添加了一个lodash throttle 来&#39;节流&#39;</p>\n<h2 id=\"创建一个vue-demo\">创建一个vue demo</h2>\n<pre><code>... ... 省略</code></pre><p>新建一个directive.js</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> Vue <span class=\"token keyword\">from</span> <span class=\"token string\">'vue'</span>\n<span class=\"token keyword\">import</span> throttle <span class=\"token keyword\">from</span> <span class=\"token string\">\"lodash/throttle\"</span><span class=\"token punctuation\">;</span>\nVue<span class=\"token punctuation\">.</span><span class=\"token function\">directive</span><span class=\"token punctuation\">(</span><span class=\"token string\">'scroll'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">inserted</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">el<span class=\"token punctuation\">,</span> binding</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> <span class=\"token function-variable function\">f</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">evt</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>binding<span class=\"token punctuation\">.</span><span class=\"token function\">value</span><span class=\"token punctuation\">(</span>evt<span class=\"token punctuation\">,</span> el<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// eslint-disable-next-line no-console</span>\n        <span class=\"token comment\">// console.log(8, binding.value(evt, el))</span>\n        <span class=\"token comment\">// remove event</span>\n        window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'scroll'</span><span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// listen event</span>\n    <span class=\"token comment\">// use lodash/throttle call methods</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'scroll'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">throttle</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// eslint-disable-next-line no-console</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">,</span> binding<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"./directive\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// main.js 里面 import</span></code></pre><p>在组件里面</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>HelloWorld</span> <span class=\"token attr-name\">v-scroll</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>handleScroll<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>box<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">msg</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Welcome to Your Vue.js App<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></code></pre><p>可以是任何元素 使用 v-scroll=&quot;xxx&quot;</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ....</span>\n    <span class=\"token function\">handleScroll</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">evt<span class=\"token punctuation\">,</span> el</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// eslint-disable-next-line no-console</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> evt<span class=\"token punctuation\">,</span> el<span class=\"token punctuation\">,</span> window<span class=\"token punctuation\">.</span>scrollY<span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// judeg window.scroll, execution TweenMax function</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>scrollY <span class=\"token operator\">></span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        TweenMax<span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">,</span> <span class=\"token number\">.3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">opacity</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n          <span class=\"token comment\">// eslint-disable-next-line no-undef</span>\n          <span class=\"token literal-property property\">ease</span><span class=\"token operator\">:</span> Sine<span class=\"token punctuation\">.</span>easeOut\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token comment\">// to meet the conditions return true else return false</span>\n      <span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span>scrollY <span class=\"token operator\">></span> <span class=\"token number\">100</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// ...</span></code></pre><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.box</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> 1.5s all <span class=\"token function\">cubic-bezier</span><span class=\"token punctuation\">(</span>0.39<span class=\"token punctuation\">,</span> 0.575<span class=\"token punctuation\">,</span> 0.565<span class=\"token punctuation\">,</span> 1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">/* transform: translate3d(0, 10px, 0); */</span>\n<span class=\"token punctuation\">}</span></code></pre>","attributes":{}},"themeConfig":{"title":"Blog(issues)","links":[{"title":"GitHub","url":"https://github.com/xiaotiandada/blog"},{"title":"Twitter","url":"https://twitter.com/XiaoTianIsMe"}]}},"__N_SSG":true}