{"pageProps":{"post":{"id":"MDU6SXNzdWU3ODg3NDUyNjE=","url":"https://github.com/xiaotiandada/blog/issues/33","title":"Building-Components shadow Dom","updatedAt":"2021-01-19T06:27:18Z","createdAt":"2021-01-19T06:27:18Z","body":" 2019-09-25 00:41:02\r\n\r\nhttps://developers.google.com/web/fundamentals/web-components/shadowdom#slots\r\n\r\n\r\n```html\r\n<!-- custom dom -->\r\n<custom-tabs>\r\n    <!-- 定义slot -->\r\n    <button slot=\"tab\">button</button>\r\n    <button slot=\"tab\">button</button>\r\n    <button slot=\"tab\">button</button>\r\n    <!-- 默认slot -->\r\n    <section>section1</section>\r\n    <section>section2</section>\r\n    <section>section3</section>\r\n  </custom-tabs>\r\n\r\n  <script>\r\n  let selected_ = null\r\n  class customTab extends HTMLElement {\r\n    constructor() {\r\n      super()\r\n\r\n      let shadowRoot = this.attachShadow({mode: 'open'})\r\n      // 样式 内容\r\n      shadowRoot.innerHTML = `\r\n        <style>\r\n          :host {\r\n            border: 1px solid #ececec;\r\n            display: inline-block;\r\n          }\r\n\r\n          #tabs ::slotted(*) {\r\n            border: none;\r\n            outline: none;\r\n            padding: 20px 40px;\r\n            background: #f1f1f1;\r\n          }\r\n\r\n          #tabs ::slotted([aria-selected=\"true\"]) {\r\n            background: #fff;\r\n          }\r\n\r\n          #panels {\r\n            padding: 20px;\r\n            font-size: 18px;\r\n          }\r\n\r\n          #panels ::slotted([aria-hidden=\"true\"]) {\r\n            display: none;\r\n          }\r\n\r\n        </style>\r\n\r\n        <div id=\"tabs\">\r\n          <slot id=\"tabSlot\" name=\"tab\"></slot>\r\n        </div>\r\n        <div id=\"panels\">\r\n          <slot id=\"panelsSlot\"></slot>\r\n        </div>\r\n      `\r\n    }\r\n\r\n    // get set\r\n    get selected() {\r\n      return selected_\r\n    }\r\n\r\n    set selected(idx) {\r\n      selected_ = idx\r\n      this._selected(idx)\r\n    }\r\n\r\n    connectedCallback() {\r\n\r\n      // set role\r\n      this.setAttribute('role', 'tab-list')\r\n\r\n      // get Element\r\n      let tabsSlot = this.shadowRoot.querySelector('#tabSlot')\r\n      let panelsSlot = this.shadowRoot.querySelector('#panelsSlot')\r\n\r\n      // filter Element\r\n      this.tabs = tabsSlot.assignedNodes({flatten: true})\r\n      this.panels = panelsSlot.assignedNodes({flatten: true}).filter(el => el.nodeType === Node.ELEMENT_NODE)\r\n\r\n\r\n      // set role\r\n      for (const [i, panel] of this.panels.entries()) {\r\n        panel.setAttribute('role', 'tab-panel')\r\n      }\r\n\r\n      // set click keydown event\r\n      this._boundOnTitleClick = this._onTitleClick.bind(this)\r\n      this._boundOnKeydown = this._onKeydown.bind(this)\r\n\r\n      tabsSlot.addEventListener('click', this._boundOnTitleClick)\r\n      tabsSlot.addEventListener('keydown', this._boundOnKeydown)\r\n\r\n      // set default selected, by tab html selected attribute\r\n      this.selected = this._findFirstSelectedTab() || 0\r\n    }\r\n\r\n    // tab click event\r\n    _onTitleClick(e) {\r\n      if (e.target.slot === 'tab') {\r\n        // now click Element index\r\n        this.selected = this.tabs.indexOf(e.target)\r\n      }\r\n    }\r\n\r\n    // tab keydown event\r\n    _onKeydown(e) {\r\n      switch(e.code) {\r\n        // up left\r\n        case 'ArrowUp':\r\n        case 'ArrowLeft':\r\n          e.preventDefault()\r\n          // --, if it's 0 idx = length - 1 else idx\r\n        var idx = this.selected - 1\r\n        idx = idx < 0 ? this.tabs.length - 1 : idx\r\n        // click event\r\n        this.tabs[idx].click()\r\n          break;\r\n          // down right\r\n        case 'ArrowDown':\r\n        case 'ArrowRight':\r\n          e.preventDefault()\r\n          // ++ by & tab click event\r\n        var idx = this.selected + 1\r\n        this.tabs[idx % this.tabs.length].click()\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    // find tab html attribute selected set now Tab\r\n    _findFirstSelectedTab() {\r\n      let selectedIdx\r\n      // for\r\n      for (const [i, tab] of this.tabs.entries()) {\r\n        // set role\r\n        tab.setAttribute('role', 'tab')\r\n        // if tab has selected, nowTab is i\r\n        if (tab.hasAttribute('selected')) {\r\n          selectedIdx = i\r\n        }\r\n      }\r\n      return selectedIdx\r\n    }\r\n\r\n    // set tab toggle function\r\n    _selected(idx = null) {\r\n      // for\r\n      for(let i = 0, tab; tab = this.tabs[i]; ++i) {\r\n        // if idx === i equal true\r\n        let selected = idx === i\r\n        // set attribute\r\n        tab.setAttribute('aria-selected', selected)\r\n        this.panels[i].setAttribute('aria-hidden', !selected)\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  if (customElements) customElements.define('custom-tabs', customTab)\r\n  else console.log('不支持 custom')\r\n  </script>\r\n```","comments":{"nodes":[]},"reactionGroups":[{"content":"THUMBS_UP","reactors":{"totalCount":0}},{"content":"THUMBS_DOWN","reactors":{"totalCount":0}},{"content":"LAUGH","reactors":{"totalCount":0}},{"content":"HOORAY","reactors":{"totalCount":0}},{"content":"CONFUSED","reactors":{"totalCount":0}},{"content":"HEART","reactors":{"totalCount":0}},{"content":"ROCKET","reactors":{"totalCount":0}},{"content":"EYES","reactors":{"totalCount":0}}],"author":{"login":"xiaotiandada","url":"https://github.com/xiaotiandada","avatarUrl":"https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d&v=4"},"html":"<p> 2019-09-25 00:41:02</p>\n<p><a href=\"https://developers.google.com/web/fundamentals/web-components/shadowdom#slots\">https://developers.google.com/web/fundamentals/web-components/shadowdom#slots</a></p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- custom dom --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>custom-tabs</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token comment\">&lt;!-- 定义slot --></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">slot</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>tab<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>button<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">slot</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>tab<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>button<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">slot</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>tab<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>button<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token comment\">&lt;!-- 默认slot --></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>section</span><span class=\"token punctuation\">></span></span>section1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>section</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>section</span><span class=\"token punctuation\">></span></span>section2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>section</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>section</span><span class=\"token punctuation\">></span></span>section3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>section</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>custom-tabs</span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">let</span> selected_ <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">customTab</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">HTMLElement</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token keyword\">let</span> shadowRoot <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">attachShadow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">mode</span><span class=\"token operator\">:</span> <span class=\"token string\">'open'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 样式 内容</span>\n      shadowRoot<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n        &lt;style>\n          :host {\n            border: 1px solid #ececec;\n            display: inline-block;\n          }\n\n          #tabs ::slotted(*) {\n            border: none;\n            outline: none;\n            padding: 20px 40px;\n            background: #f1f1f1;\n          }\n\n          #tabs ::slotted([aria-selected=\"true\"]) {\n            background: #fff;\n          }\n\n          #panels {\n            padding: 20px;\n            font-size: 18px;\n          }\n\n          #panels ::slotted([aria-hidden=\"true\"]) {\n            display: none;\n          }\n\n        &lt;/style>\n\n        &lt;div id=\"tabs\">\n          &lt;slot id=\"tabSlot\" name=\"tab\">&lt;/slot>\n        &lt;/div>\n        &lt;div id=\"panels\">\n          &lt;slot id=\"panelsSlot\">&lt;/slot>\n        &lt;/div>\n      </span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// get set</span>\n    <span class=\"token keyword\">get</span> <span class=\"token function\">selected</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> selected_\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">set</span> <span class=\"token function\">selected</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">idx</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      selected_ <span class=\"token operator\">=</span> idx\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_selected</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token comment\">// set role</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'role'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tab-list'</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\">// get Element</span>\n      <span class=\"token keyword\">let</span> tabsSlot <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>shadowRoot<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#tabSlot'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">let</span> panelsSlot <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>shadowRoot<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#panelsSlot'</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\">// filter Element</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabs <span class=\"token operator\">=</span> tabsSlot<span class=\"token punctuation\">.</span><span class=\"token function\">assignedNodes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">flatten</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>panels <span class=\"token operator\">=</span> panelsSlot<span class=\"token punctuation\">.</span><span class=\"token function\">assignedNodes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">flatten</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=></span> el<span class=\"token punctuation\">.</span>nodeType <span class=\"token operator\">===</span> Node<span class=\"token punctuation\">.</span><span class=\"token constant\">ELEMENT_NODE</span><span class=\"token punctuation\">)</span>\n\n\n      <span class=\"token comment\">// set role</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> panel<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>panels<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        panel<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'role'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tab-panel'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// set click keydown event</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_boundOnTitleClick <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_onTitleClick</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_boundOnKeydown <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_onKeydown</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\n\n      tabsSlot<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_boundOnTitleClick<span class=\"token punctuation\">)</span>\n      tabsSlot<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'keydown'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_boundOnKeydown<span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\">// set default selected, by tab html selected attribute</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>selected <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_findFirstSelectedTab</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// tab click event</span>\n    <span class=\"token function\">_onTitleClick</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>slot <span class=\"token operator\">===</span> <span class=\"token string\">'tab'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// now click Element index</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>selected <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// tab keydown event</span>\n    <span class=\"token function\">_onKeydown</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// up left</span>\n        <span class=\"token keyword\">case</span> <span class=\"token string\">'ArrowUp'</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">case</span> <span class=\"token string\">'ArrowLeft'</span><span class=\"token operator\">:</span>\n          e<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token comment\">// --, if it's 0 idx = length - 1 else idx</span>\n        <span class=\"token keyword\">var</span> idx <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>selected <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n        idx <span class=\"token operator\">=</span> idx <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> idx\n        <span class=\"token comment\">// click event</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n          <span class=\"token comment\">// down right</span>\n        <span class=\"token keyword\">case</span> <span class=\"token string\">'ArrowDown'</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">case</span> <span class=\"token string\">'ArrowRight'</span><span class=\"token operator\">:</span>\n          e<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token comment\">// ++ by &amp; tab click event</span>\n        <span class=\"token keyword\">var</span> idx <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>selected <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">[</span>idx <span class=\"token operator\">%</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n          <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// find tab html attribute selected set now Tab</span>\n    <span class=\"token function\">_findFirstSelectedTab</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> selectedIdx\n      <span class=\"token comment\">// for</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> tab<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// set role</span>\n        tab<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'role'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tab'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// if tab has selected, nowTab is i</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tab<span class=\"token punctuation\">.</span><span class=\"token function\">hasAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'selected'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          selectedIdx <span class=\"token operator\">=</span> i\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> selectedIdx\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// set tab toggle function</span>\n    <span class=\"token function\">_selected</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">idx <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// for</span>\n      <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> tab<span class=\"token punctuation\">;</span> tab <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tabs<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// if idx === i equal true</span>\n        <span class=\"token keyword\">let</span> selected <span class=\"token operator\">=</span> idx <span class=\"token operator\">===</span> i\n        <span class=\"token comment\">// set attribute</span>\n        tab<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'aria-selected'</span><span class=\"token punctuation\">,</span> selected<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>panels<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'aria-hidden'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">!</span>selected<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>customElements<span class=\"token punctuation\">)</span> customElements<span class=\"token punctuation\">.</span><span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token string\">'custom-tabs'</span><span class=\"token punctuation\">,</span> customTab<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">else</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'不支持 custom'</span><span class=\"token punctuation\">)</span>\n  </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre>","attributes":{}},"themeConfig":{"title":"Blog(issues)","links":[{"title":"GitHub","url":"https://github.com/xiaotiandada/blog"},{"title":"Twitter","url":"https://twitter.com/XiaoTianIsMe"}]}},"__N_SSG":true}