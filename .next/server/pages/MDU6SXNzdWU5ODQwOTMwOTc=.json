{"pageProps":{"post":{"id":"MDU6SXNzdWU5ODQwOTMwOTc=","url":"https://github.com/xiaotiandada/blog/issues/85","title":"Vuex 源码研究","updatedAt":"2021-08-31T17:17:07Z","createdAt":"2021-08-31T17:10:04Z","body":"\r\n\r\n- https://tech.meituan.com/2017/04/27/vuex-code-analysis.htm\r\n- https://github.com/answershuto/learnVue/blob/master/docs/Vuex%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.MarkDown\r\n\r\n\r\n- https://github.com/xiaotiandada/Case/tree/master/vuex-learn\r\n\r\n\r\n\r\n## Index.js\r\n\r\n```javascript\r\nimport { Store, install } from './store'\r\n```\r\n\r\n导入/导出各个模块功能\r\n\r\n### Store.js\r\n\r\n```javascript\r\nif (!Vue && typeof window !== 'undefined' && window.Vue) {\r\n\tinstall(window.Vue)\r\n}\r\n```\r\n\r\n在 Vue 环境中安装\r\n\r\n```javascript\r\nif (__DEV__) {\r\n  assert(Vue, `must call Vue.use(Vuex) before creating a store instance.`)\r\n  assert(typeof Promise !== 'undefined', `vuex requires a Promise polyfill in this browser.`)\r\n  assert(this instanceof Store, `store must be called with the new operator.`)\r\n}\r\n```\r\n\r\n开发模式断言\r\n\r\n```javascript\r\n    const {\r\n      // 一个数组，包含应用在 store 上的插件方法。\r\n      plugins = [],\r\n      // 使 Vuex store 进入严格模式，在严格模式下，任何 mutation 处理函数以外修改 Vuex state 都会抛出错误。\r\n      strict = false\r\n    } = options\r\n```\r\n\r\n","comments":{"nodes":[]},"reactionGroups":[{"content":"THUMBS_UP","reactors":{"totalCount":0}},{"content":"THUMBS_DOWN","reactors":{"totalCount":0}},{"content":"LAUGH","reactors":{"totalCount":0}},{"content":"HOORAY","reactors":{"totalCount":0}},{"content":"CONFUSED","reactors":{"totalCount":0}},{"content":"HEART","reactors":{"totalCount":0}},{"content":"ROCKET","reactors":{"totalCount":0}},{"content":"EYES","reactors":{"totalCount":0}}],"author":{"login":"xiaotiandada","url":"https://github.com/xiaotiandada","avatarUrl":"https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d&v=4"},"html":"<ul>\n<li><p><a href=\"https://tech.meituan.com/2017/04/27/vuex-code-analysis.htm\">https://tech.meituan.com/2017/04/27/vuex-code-analysis.htm</a></p>\n</li>\n<li><p><a href=\"https://github.com/answershuto/learnVue/blob/master/docs/Vuex%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.MarkDown\">https://github.com/answershuto/learnVue/blob/master/docs/Vuex%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.MarkDown</a></p>\n</li>\n<li><p><a href=\"https://github.com/xiaotiandada/Case/tree/master/vuex-learn\">https://github.com/xiaotiandada/Case/tree/master/vuex-learn</a></p>\n</li>\n</ul>\n<h2 id=\"indexjs\">Index.js</h2>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Store<span class=\"token punctuation\">,</span> install <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./store'</span></code></pre><p>导入/导出各个模块功能</p>\n<h3 id=\"storejs\">Store.js</h3>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Vue <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">typeof</span> window <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span> <span class=\"token operator\">&amp;&amp;</span> window<span class=\"token punctuation\">.</span>Vue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">install</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>Vue<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre><p>在 Vue 环境中安装</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>__DEV__<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>Vue<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">must call Vue.use(Vuex) before creating a store instance.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> Promise <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">vuex requires a Promise polyfill in this browser.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span> <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Store</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">store must be called with the new operator.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre><p>开发模式断言</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\">    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 一个数组，包含应用在 store 上的插件方法。</span>\n      plugins <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">// 使 Vuex store 进入严格模式，在严格模式下，任何 mutation 处理函数以外修改 Vuex state 都会抛出错误。</span>\n      strict <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> options</code></pre>","attributes":{}},"themeConfig":{"title":"Blog(issues)","links":[{"title":"GitHub","url":"https://github.com/xiaotiandada/blog"},{"title":"Twitter","url":"https://twitter.com/XiaoTianIsMe"}]}},"__N_SSG":true}