<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>bilibili banneråŠ¨ç”»ç ”ç©¶ã€ä¸€ã€‘ - Blog(issues)</title><meta property="og:type" content="artical"/><meta property="og:title" content="bilibili banneråŠ¨ç”»ç ”ç©¶ã€ä¸€ã€‘"/><meta property="og:image" content="
        https://og-image.vercel.app/bilibili banneråŠ¨ç”»ç ”ç©¶ã€ä¸€ã€‘.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-black.svg
      "/><meta property="article:published_time" content="2021-01-19T06:40:19Z"/><meta property="article:author" content="xiaotiandada"/><meta name="twitter:card" content="bilibili banneråŠ¨ç”»ç ”ç©¶ã€ä¸€ã€‘"/><meta name="twitter:title" content="bilibili banneråŠ¨ç”»ç ”ç©¶ã€ä¸€ã€‘"/><meta name="twitter:image" content="
        https://og-image.vercel.app/bilibili banneråŠ¨ç”»ç ”ç©¶ã€ä¸€ã€‘.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fvercel-triangle-black.svg
      "/><meta name="next-head-count" content="4"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""/><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&amp;display=swap" rel="stylesheet"/><link rel="preload" href="/_next/static/css/b78bfc7021c6877d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b78bfc7021c6877d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-2190439a97dca295.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2aac380799256b7f.js" defer=""></script><script src="/_next/static/chunks/pages/%5B...path%5D-e0b96643230aac68.js" defer=""></script><script src="/_next/static/YPEk3V-eoVeml18YoUSCM/_buildManifest.js" defer=""></script><script src="/_next/static/YPEk3V-eoVeml18YoUSCM/_ssgManifest.js" defer=""></script><script src="/_next/static/YPEk3V-eoVeml18YoUSCM/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div><div class="container mx-auto mt-24 max-w-2xl px-4 sm:px-0"><div><div class="flex my-8 font-bold"><a href="/">Blog(issues)</a></div></div><div class="mb-8"><div class="text-3xl font-medium">bilibili banneråŠ¨ç”»ç ”ç©¶ã€ä¸€ã€‘</div><div class="flex mt-4 items-center gap-2"><img class="w-8 h-8 rounded-full" src="https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d&amp;v=4"/><a target="_blank" href="https://github.com/xiaotiandada">xiaotiandada</a><a class="underline text-sm" target="_blank" href="https://github.com/xiaotiandada/blog/issues/61">View on GitHub</a></div><div class="my-8"><div class="flex gap-4 flex-wrap"></div></div></div><div class="post-body"><p> 2020-11-16 21:52:56</p>
<p><img src="https://i.imgur.com/2BWZJjY.jpg?1" alt="åŠ¨ç”»æ•ˆæœ"></p>
<p><a href="https://www.bilibili.com/">https://www.bilibili.com/</a> åé¢å¯èƒ½ä¼šè¢«æ›´æ–°æ‰</p>
<blockquote>
<p>Â ä¸ºä»€ä¹ˆå«ä¸€ï¼Ÿ è¯´ä¸èƒ½è¿˜æœ‰åˆ«çš„å¥½ç©çš„åŠ¨ç”»å­¦ä¹ ï¼</p>
</blockquote>
<!-- more -->

<iframe src="https://codesandbox.io/embed/bilibili-bannner-w49d7?fontsize=14&hidenavigation=1&theme=dark&view=preview"
     style="width:100%; height:200px; border:0; border-radius: 4px; overflow:hidden;"
     title="bilibili bannner"
     allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
     sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
   ></iframe>

<p>ä¸»è¦ä¸¤ä¸ªç»„ä»¶å®Œæˆï¼Œä»£ç æˆ‘ä¹Ÿæ˜¯å¤åˆ¶bç«™å¤§ä½¬çš„ğŸ‘ ç„¶åè‡ªå·±ç†è§£ç†è§£æ€è·¯</p>
<h3 id="bannervue">Banner.vue</h3>
<pre class="language-javascript"><code class="language-javascript">  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">locs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token comment">//...</span>
        <span class="token literal-property property">pic</span><span class="token operator">:</span>
          <span class="token string">"http://i0.hdslb.com/bfs/archive/0b7eef054547750e6bfeff6f36c83e83d2a058fb.png"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">litpic</span><span class="token operator">:</span>
          <span class="token string">"http://i0.hdslb.com/bfs/archive/622017dd4b0140432962d3ce0c6db99d77d2e937.png"</span><span class="token punctuation">,</span>
                <span class="token comment">//...</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">bannerImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>locs <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>locs<span class="token punctuation">.</span>pic<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">logoImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>locs <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>locs<span class="token punctuation">.</span>litpic<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre><p>è¿”å›ä¸€å¼ é™æ­¢çš„é¡µé¢ï¼Œåœ¨æ²¡æœ‰åŠ è½½å®Œæˆæˆ–è€…ä¸æ”¯æŒçš„æ—¶å€™æ˜¾ç¤º</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// è§£ææ•°æ® æå‰å®šä¹‰å¥½çš„å…·ä½“çœ‹ä»£ç </span>
<span class="token keyword">this</span><span class="token punctuation">.</span>layerConfig <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'[...]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è§£æbanneræ•°æ®</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// åªæœ‰åœ¨å¯ç”¨äº†åŠ¨ç”»bannerçš„é…ç½®ï¼Œä¸”æµè§ˆå™¨æ”¯æŒcss filteræ—¶æ‰åŠ è½½åŠ¨ç”»bannerçš„å›¾ç‰‡èµ„æº</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>animatedBannerSupport <span class="token operator">=</span>
  <span class="token keyword">typeof</span> <span class="token constant">CSS</span> <span class="token operator">!==</span> <span class="token string">"undefined"</span> <span class="token operator">&amp;&amp;</span>
  <span class="token constant">CSS</span><span class="token punctuation">.</span>supports <span class="token operator">&amp;&amp;</span>
  <span class="token constant">CSS</span><span class="token punctuation">.</span><span class="token function">supports</span><span class="token punctuation">(</span><span class="token string">"filter: blur(1px)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æŸ¥çœ‹æ˜¯å¦æ”¯æŒä¸€äº›éœ€è¦çš„æ¡ä»¶</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// æ ¹æ®æ¯å¸§æ—¶é•¿è®¡ç®—å¾ªç¯æ—¶é—´</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>layerConfig<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  v<span class="token punctuation">.</span>loopTime <span class="token operator">=</span> v<span class="token punctuation">.</span>images<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token operator">=></span> p <span class="token operator">+</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span>duration <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ç»Ÿè®¡æ‰€æœ‰Time åˆ©ç”¨ Reduce ç´¯è®¡</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token comment">// åŠ è½½æ‰€æœ‰å›¾ç‰‡èµ„æº</span>
  <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>layerConfig<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"v"</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>
        v<span class="token punctuation">.</span>images<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          img<span class="token punctuation">.</span>src <span class="token operator">=</span> i<span class="token punctuation">.</span>src<span class="token punctuation">;</span>
          <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>img<span class="token punctuation">.</span>onload <span class="token operator">=</span> resolve<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          v<span class="token punctuation">.</span>images<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>img <span class="token operator">=</span> img<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"this.layerConfig"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// åˆ‡æ¢ä¸ºåŠ¨ç”»banner</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>animatedBannerLoaded <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"load animated banner images error"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>åˆ©ç”¨PromiseåŠ è½½æ‰€æœ‰å›¾ç‰‡èµ„æºï¼Œä¸¤ä¸ªPromiseæ˜¯å› ä¸ºimagesé‡Œé¢ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„</p>
<p>å¯ä»¥ç”¨è¿™ç§æ–¹æ³•æå‰åŠ è½½å›¾ç‰‡ è¿™æ ·åˆ‡æ¢çš„æ—¶å€™å°±ä¸ä¼šå¾ˆå¡é¡¿ å—¯ å­¦ä¹ äº†ï¼</p>
<h3 id="animatedbanner">AnimatedBanner</h3>
<pre class="language-javascript"><code class="language-javascript"><span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">layerConfig</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> Array<span class="token punctuation">,</span>
      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre><p>æ¥æ”¶çˆ¶ç»„ä»¶å¤„ç†å¥½çš„æ•°ç»„æ•°æ®</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> layerConfig <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerConfig<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>layerConfig<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">[</span><span class="token string">"container"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> containerHeight <span class="token operator">=</span> container<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
<span class="token keyword">let</span> containerWidth <span class="token operator">=</span> container<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>
<span class="token keyword">let</span> containerScale <span class="token operator">=</span> containerHeight <span class="token operator">/</span> <span class="token number">155</span><span class="token punctuation">;</span>

<span class="token comment">// åŠ è½½å›¾ç‰‡èµ„æºç§»åŠ¨åˆ°ç»„ä»¶å¤–éƒ¨ï¼Œ è¿™é‡Œåªè®¾ç½®å›¾ç‰‡å®½é«˜</span>
layerConfig<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  v<span class="token punctuation">.</span>images<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> img <span class="token operator">=</span> v<span class="token punctuation">.</span>images<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>img<span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>height <span class="token operator">=</span> img<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>width <span class="token operator">=</span> img<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>height <span class="token operator">=</span>
      img<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>height <span class="token operator">*</span> containerScale <span class="token operator">*</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>scale <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>width <span class="token operator">=</span> img<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>width <span class="token operator">*</span> containerScale <span class="token operator">*</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>scale <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>å¦‚æœæ²¡æœ‰è°ƒç”¨$emitå‘Šè¯‰çˆ¶ç»„ä»¶æ˜¾ç¤ºé™æ€å›¾ç‰‡</p>
<p>è·å–å®¹å™¨å’Œå®½é«˜ç¼©æ”¾ç­‰å±æ€§ï¼Œå¹¶ä¸”è®¾ç½®çˆ¶ç»„ä»¶è·å–å›¾ç‰‡çš„å®½é«˜ç­‰å±æ€§ å¹¶ä¸”æ ¹æ®ç¼©æ”¾æ¯”ä¾‹è®¡ç®—</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// åˆå§‹åŒ–å›¾å±‚</span>
<span class="token keyword">const</span> layers <span class="token operator">=</span> layerConfig<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> layer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  layer<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"layer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> layer<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åˆå§‹åŒ–å›¾å±‚åˆ°container</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// åˆå§‹çŠ¶æ€</span>
<span class="token keyword">const</span> <span class="token function-variable function">iaf</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    layers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">layer<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// console.log("layer log", i, layer);</span>
      <span class="token keyword">const</span> v <span class="token operator">=</span> layerConfig<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> a <span class="token operator">=</span> layer<span class="token punctuation">.</span>firstChild<span class="token punctuation">;</span>
      <span class="token comment">// console.log("a", a);</span>
      <span class="token keyword">let</span> rotateStr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> translateStr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>rotate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rotateStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rotate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>rotate<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">deg)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>translate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> base <span class="token operator">=</span> v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>translate <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        translateStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>base<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>base<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      a<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>translateStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rotateStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>blur<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">.</span>style<span class="token punctuation">.</span>filter <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">blur(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>blur<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ‡æ¢ä¸‹ä¸€å¸§çš„æ–¹æ³•</span>
<span class="token keyword">const</span> <span class="token function-variable function">changeToNextFrame</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">layer<span class="token punctuation">,</span> images<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> next <span class="token operator">=</span> i <span class="token operator">===</span> images<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    layer<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span><span class="token punctuation">;</span>
    layer<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>images<span class="token punctuation">[</span>next<span class="token punctuation">]</span><span class="token punctuation">.</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">changeToNextFrame</span><span class="token punctuation">(</span>layer<span class="token punctuation">,</span> images<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>af<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// åˆå§‹åŒ–å›¾å±‚å†…å›¾ç‰‡å’Œå¸§åŠ¨ç”»</span>
layerConfig<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> a <span class="token operator">=</span> v<span class="token punctuation">.</span>images<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>img<span class="token punctuation">;</span>
  layers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>iaf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>images<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> v<span class="token punctuation">.</span>loopTime <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">changeToNextFrame</span><span class="token punctuation">(</span>layers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span>images<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åˆå§‹åŒ–å›¾å±‚å›¾ç‰‡å’Œä¸€äº›é»˜è®¤æ ·å¼å¹¶ä¸”å¼€å§‹å¸§åŠ¨ç”»</p>
<p>åˆ©ç”¨å®šæ—¶å™¨loop toggle img åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ç„¶åæ·»åŠ ä¸‹ä¸€å¸§å›¾ç‰‡ç„¶åå†è°ƒç”¨è‡ªå·±</p>
<pre class="language-javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mouseleave"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseLeave<span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousemove"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"mouseleave"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseLeave<span class="token punctuation">)</span><span class="token punctuation">;</span>
  window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"mousemove"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">)</span><span class="token punctuation">;</span>
  window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre><p>ç›‘å¬ä¸€äº›äº‹ä»¶</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">handleMouseMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> offsetY <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">+</span> e<span class="token punctuation">.</span>clientY<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"offsetY"</span><span class="token punctuation">,</span> offsetY<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>offsetY <span class="token operator">&lt;</span> containerHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>entered<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      entered <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      enterX <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    displace <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX <span class="token operator">-</span> enterX<span class="token punctuation">)</span> <span class="token operator">/</span> containerWidth<span class="token punctuation">;</span>
    <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>raf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    raf <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>af<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>entered<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      entered <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token function">handleLeave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>é¼ æ ‡ç»è¿‡å®¹å™¨æ‰§è¡Œaf å…ˆå–æ¶ˆå†ç»§ç»­ï¼Œä¸åœ¨å®¹å™¨å†…è°ƒç”¨ handleLeave</p>
<pre class="language-javascript"><code class="language-javascript">enterX <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX<span class="token punctuation">;</span>
displace <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX <span class="token operator">-</span> enterX<span class="token punctuation">)</span> <span class="token operator">/</span> containerWidth<span class="token punctuation">;</span></code></pre><p>è¿™ä¸¤ä¸ªçš„å«ä¹‰å…¶å®æˆ‘è¿˜æ²¡å¤ªç†è§£ åç»­éœ€è¦ç”¨ displace å‚ä¸è®¡ç®— åº”è¯¥å°±æ˜¯ç”¨æ¥åˆ¤æ–­å¾€å·¦è¿˜æ˜¯å³è¾¹çš„</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// æ ¹æ®é¼ æ ‡ä½ç½®æ”¹å˜çŠ¶æ€</span>
<span class="token keyword">const</span> <span class="token function-variable function">af</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    layers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">layer<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> v <span class="token operator">=</span> layerConfig<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> a <span class="token operator">=</span> layer<span class="token punctuation">.</span>firstChild<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>v<span class="token punctuation">.</span>offset <span class="token operator">||</span> <span class="token operator">!</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">const</span> baseRotate <span class="token operator">=</span> v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>rotate <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> baseTranslate <span class="token operator">=</span> v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>trannslate <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> scaleStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> rotateStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rotate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>rotate <span class="token operator">||</span> <span class="token number">0</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">deg)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> translateStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>baseTranslate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>baseTranslate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
        <span class="token string">"rotateStr translateStr"</span><span class="token punctuation">,</span>
        rotateStr<span class="token punctuation">,</span>
        translateStr<span class="token punctuation">,</span>
        v<span class="token punctuation">.</span>offset
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>scale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> itp <span class="token operator">=</span>
              v<span class="token punctuation">.</span>offsetCurve <span class="token operator">&amp;&amp;</span> v<span class="token punctuation">.</span>offsetCurve<span class="token punctuation">.</span>scale
        <span class="token operator">?</span> <span class="token function">curveParameterToFunc</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>offsetCurve<span class="token punctuation">.</span>scale<span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=></span> x<span class="token punctuation">;</span>
        <span class="token keyword">const</span> offset <span class="token operator">=</span> v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>scale <span class="token operator">*</span> <span class="token function">itp</span><span class="token punctuation">(</span>displace<span class="token punctuation">)</span><span class="token punctuation">;</span>
        scaleStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">scale(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">1</span> <span class="token operator">+</span> offset<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>rotate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> itp <span class="token operator">=</span>
              v<span class="token punctuation">.</span>offsetCurve <span class="token operator">&amp;&amp;</span> v<span class="token punctuation">.</span>offsetCurve<span class="token punctuation">.</span>rotate
        <span class="token operator">?</span> <span class="token function">curveParameterToFunc</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>offsetCurve<span class="token punctuation">.</span>rotate<span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=></span> x<span class="token punctuation">;</span>
        <span class="token keyword">const</span> offset <span class="token operator">=</span> v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>rotate <span class="token operator">*</span> <span class="token function">itp</span><span class="token punctuation">(</span>displace<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rotateStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rotate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>baseRotate <span class="token operator">+</span> offset<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">deg)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>translate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> itp <span class="token operator">=</span>
              v<span class="token punctuation">.</span>offsetCurve <span class="token operator">&amp;&amp;</span> v<span class="token punctuation">.</span>offsetCurve<span class="token punctuation">.</span>translate
        <span class="token operator">?</span> <span class="token function">curveParameterToFunc</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>offsetCurve<span class="token punctuation">.</span>translate<span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=></span> x<span class="token punctuation">;</span>
        <span class="token keyword">const</span> offset <span class="token operator">=</span> v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>translate<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">itp</span><span class="token punctuation">(</span>displace<span class="token punctuation">)</span> <span class="token operator">*</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> translate <span class="token operator">=</span> baseTranslate<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span>
          <span class="token punctuation">(</span>x <span class="token operator">+</span> offset<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> containerScale <span class="token operator">*</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>scale <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        translateStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>translate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>translate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      a<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scaleStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>translateStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rotateStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>blur<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> itp <span class="token operator">=</span>
              v<span class="token punctuation">.</span>offsetCurve <span class="token operator">&amp;&amp;</span> v<span class="token punctuation">.</span>offsetCurve<span class="token punctuation">.</span>blur
        <span class="token operator">?</span> <span class="token function">curveParameterToFunc</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>offsetCurve<span class="token punctuation">.</span>blur<span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=></span> x<span class="token punctuation">;</span>
        <span class="token keyword">const</span> blurOffset <span class="token operator">=</span> <span class="token function">itp</span><span class="token punctuation">(</span>displace<span class="token punctuation">)</span> <span class="token operator">*</span> v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>blur<span class="token punctuation">;</span>
        a<span class="token punctuation">.</span>style<span class="token punctuation">.</span>filter <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">blur(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>blur <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> blurOffset
        <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>å…³é”®ä»£ç åœ¨è¿™é‡Œ...</p>
<ol>
<li><p>åˆ¤æ–­æœ‰æ²¡æœ‰å…ƒç´ </p>
</li>
<li><p>è·å–ä¸€äº›åˆå§‹çš„style</p>
</li>
<li><p>ç„¶ååˆ¤æ–­æœ‰æ²¡æœ‰offset scale rotate translate blur ç„¶åæ‰§è¡ŒåŠ¨ç”»</p>
</li>
<li><p>åˆ¤æ–­æœ‰æ²¡æœ‰ offset curve å¦‚æœæœ‰ç”¨ cubicBezier æ²¡æœ‰å°±ç”¨é»˜è®¤å‚æ•°</p>
</li>
<li><p>å¾€å³è¾¹ x2 &gt; x1 / width æ­£æ•°</p>
<ol>
<li><p>Scale é»˜è®¤æ˜¯ 1</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> offset <span class="token operator">=</span> v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>scale <span class="token operator">*</span> <span class="token function">itp</span><span class="token punctuation">(</span>displace<span class="token punctuation">)</span><span class="token punctuation">;</span>
scaleStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">scale(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">1</span> <span class="token operator">+</span> offset<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre></li>
<li><p>Rotate æ ¹æ®ä¸Šé¢å®šä¹‰çš„é»˜è®¤å‚æ•°ç„¶ååŠ ä¸Šæ–°è§’åº¦</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> offset <span class="token operator">=</span> v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>rotate <span class="token operator">*</span> <span class="token function">itp</span><span class="token punctuation">(</span>displace<span class="token punctuation">)</span><span class="token punctuation">;</span>
rotateStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rotate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>baseRotate <span class="token operator">+</span> offset<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">deg)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre></li>
<li><p>Translate æ ¹æ®æ¯”ä¾‹è®¡ç®—</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> offset <span class="token operator">=</span> v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>translate<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">itp</span><span class="token punctuation">(</span>displace<span class="token punctuation">)</span> <span class="token operator">*</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> translate <span class="token operator">=</span> baseTranslate<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  <span class="token punctuation">(</span>x <span class="token operator">+</span> offset<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> containerScale <span class="token operator">*</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>scale <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
translateStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>translate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>translate<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre><p>å› ä¸ºæ˜¯ä¸ªarræ‰€ä»¥map loopï¼Œåé¢çš„ * å®¹å™¨æ¯”ä¾‹ * åˆå§‹åŒ–scale åº”è¯¥æ˜¯é€‚é…ç¼©æ”¾çš„æ¯”ä¾‹ç„¶åå˜åŒ–ä½ç½®</p>
<pre class="language-javascript"><code class="language-javascript">a<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scaleStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>translateStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rotateStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre><p>æœ€åè®¾ç½®å±æ€§</p>
</li>
<li><p>blur åˆå§‹çš„blur + å˜åŒ–åçš„blur</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> blurOffset <span class="token operator">=</span> <span class="token function">itp</span><span class="token punctuation">(</span>displace<span class="token punctuation">)</span> <span class="token operator">*</span> v<span class="token punctuation">.</span>offset<span class="token punctuation">.</span>blur<span class="token punctuation">;</span>
a<span class="token punctuation">.</span>style<span class="token punctuation">.</span>filter <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">blur(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span>v<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>blur <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> blurOffset
<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre></li>
</ol>
</li>
</ol>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">handleLeave</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> now <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> timeout <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> tempDisplace <span class="token operator">=</span> displace<span class="token punctuation">;</span>
  <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>raf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">leaveAF</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">-</span> now <span class="token operator">&lt;</span> timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      displace <span class="token operator">=</span> tempDisplace <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token punctuation">(</span>t <span class="token operator">-</span> now<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">af</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>leaveAF<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      displace <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token function">af</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  raf <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>leaveAF<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>é¼ æ ‡ç¦»å¼€å åœ¨200timeå†…displaceä¼šé€æ¸å˜å°æˆ–æ‰©å¤§ å–å†³äºæ­£æ•°è¿˜æ˜¯è´Ÿæ•° è¶…è¿‡æ—¶é—´åä¼šè®¾ç½®ä¸º 0 ç„¶åè°ƒç”¨åŠ¨ç”»æ¢å¤é»˜è®¤å‚æ•°</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">handleResize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  containerHeight <span class="token operator">=</span> container<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
  containerWidth <span class="token operator">=</span> container<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>
  containerScale <span class="token operator">=</span> containerHeight <span class="token operator">/</span> <span class="token number">155</span><span class="token punctuation">;</span>
  layerConfig<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">lc</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    lc<span class="token punctuation">.</span>images<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> img <span class="token operator">=</span> i<span class="token punctuation">.</span>img<span class="token punctuation">;</span>
      img<span class="token punctuation">.</span>height <span class="token operator">=</span>
        img<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>height <span class="token operator">*</span> containerScale <span class="token operator">*</span> <span class="token punctuation">(</span>lc<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>scale <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      img<span class="token punctuation">.</span>width <span class="token operator">=</span>
        img<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>width <span class="token operator">*</span> containerScale <span class="token operator">*</span> <span class="token punctuation">(</span>lc<span class="token punctuation">.</span>initial<span class="token punctuation">.</span>scale <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>raf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  raf <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">af</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Â è®¾ç½®å®¹å™¨çš„æ ·å¼å‚æ•°ç„¶åå–æ¶ˆåŠ¨ç”»å†å¼€å§‹åŠ¨ç”»èµ‹å€¼ç»™raf</p>
</div><hr class="my-12"/><div class="font-sans"><div class="mb-12"><a target="_blank" href="https://github.com/xiaotiandada/blog/issues/61" class="font-medium border border-gray-700 hover:bg-gray-700 hover:text-gray-100 transition-all text-gray-700 text-sm rounded px-4 py-2">Add comment</a></div></div><div class="my-12"><div class="text-sm">Powered by <a class="underline" target="_blank" href="https://github.com/djyde/sairin">Sairin</a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"MDU6SXNzdWU3ODg3NTE4NDk=","url":"https://github.com/xiaotiandada/blog/issues/61","title":"bilibili banneråŠ¨ç”»ç ”ç©¶ã€ä¸€ã€‘","updatedAt":"2021-01-19T06:40:19Z","createdAt":"2021-01-19T06:40:19Z","body":" 2020-11-16 21:52:56\r\n\r\n![åŠ¨ç”»æ•ˆæœ](https://i.imgur.com/2BWZJjY.jpg?1)\r\n\r\nhttps://www.bilibili.com/ åé¢å¯èƒ½ä¼šè¢«æ›´æ–°æ‰\r\n\r\n\u003e Â ä¸ºä»€ä¹ˆå«ä¸€ï¼Ÿ è¯´ä¸èƒ½è¿˜æœ‰åˆ«çš„å¥½ç©çš„åŠ¨ç”»å­¦ä¹ ï¼\r\n\r\n\u003c!-- more --\u003e\r\n\r\n\u003ciframe src=\"https://codesandbox.io/embed/bilibili-bannner-w49d7?fontsize=14\u0026hidenavigation=1\u0026theme=dark\u0026view=preview\"\r\n     style=\"width:100%; height:200px; border:0; border-radius: 4px; overflow:hidden;\"\r\n     title=\"bilibili bannner\"\r\n     allow=\"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking\"\r\n     sandbox=\"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts\"\r\n   \u003e\u003c/iframe\u003e\r\n\r\nä¸»è¦ä¸¤ä¸ªç»„ä»¶å®Œæˆï¼Œä»£ç æˆ‘ä¹Ÿæ˜¯å¤åˆ¶bç«™å¤§ä½¬çš„ğŸ‘ ç„¶åè‡ªå·±ç†è§£ç†è§£æ€è·¯\r\n\r\n### Banner.vue\r\n\r\n```javascript\r\n  computed: {\r\n    locs() {\r\n      return {\r\n    \t\t//...\r\n        pic:\r\n          \"http://i0.hdslb.com/bfs/archive/0b7eef054547750e6bfeff6f36c83e83d2a058fb.png\",\r\n        litpic:\r\n          \"http://i0.hdslb.com/bfs/archive/622017dd4b0140432962d3ce0c6db99d77d2e937.png\",\r\n\t\t\t\t//...\r\n      };\r\n    },\r\n    bannerImg() {\r\n      return (this.locs \u0026\u0026 this.locs.pic).trim();\r\n    },\r\n    logoImg() {\r\n      return (this.locs \u0026\u0026 this.locs.litpic).trim();\r\n    },\r\n  },\r\n```\r\n\r\nè¿”å›ä¸€å¼ é™æ­¢çš„é¡µé¢ï¼Œåœ¨æ²¡æœ‰åŠ è½½å®Œæˆæˆ–è€…ä¸æ”¯æŒçš„æ—¶å€™æ˜¾ç¤º\r\n\r\n```javascript\r\n// è§£ææ•°æ® æå‰å®šä¹‰å¥½çš„å…·ä½“çœ‹ä»£ç \r\nthis.layerConfig = JSON.parse('[...]');\r\n```\r\n\r\nè§£æbanneræ•°æ®\r\n\r\n```javascript\r\n// åªæœ‰åœ¨å¯ç”¨äº†åŠ¨ç”»bannerçš„é…ç½®ï¼Œä¸”æµè§ˆå™¨æ”¯æŒcss filteræ—¶æ‰åŠ è½½åŠ¨ç”»bannerçš„å›¾ç‰‡èµ„æº\r\nthis.animatedBannerSupport =\r\n  typeof CSS !== \"undefined\" \u0026\u0026\r\n  CSS.supports \u0026\u0026\r\n  CSS.supports(\"filter: blur(1px)\");\r\n```\r\n\r\næŸ¥çœ‹æ˜¯å¦æ”¯æŒä¸€äº›éœ€è¦çš„æ¡ä»¶\r\n\r\n```javascript\r\n// æ ¹æ®æ¯å¸§æ—¶é•¿è®¡ç®—å¾ªç¯æ—¶é—´\r\nthis.layerConfig.map((v) =\u003e {\r\n  v.loopTime = v.images.reduce((p, c) =\u003e p + (c.duration || 0), 0);\r\n});\r\n```\r\n\r\nç»Ÿè®¡æ‰€æœ‰Time åˆ©ç”¨ Reduce ç´¯è®¡\r\n\r\n```javascript\r\ntry {\r\n  // åŠ è½½æ‰€æœ‰å›¾ç‰‡èµ„æº\r\n  await Promise.all(\r\n    this.layerConfig.map(async (v) =\u003e {\r\n      console.log(\"v\", v);\r\n      return Promise.all(\r\n        v.images.map(async (i, index) =\u003e {\r\n          const img = document.createElement(\"img\");\r\n          img.src = i.src;\r\n          await new Promise((resolve) =\u003e (img.onload = resolve));\r\n          v.images[index].img = img;\r\n        })\r\n      );\r\n    })\r\n  );\r\n  console.log(\"this.layerConfig\", this.layerConfig);\r\n  // åˆ‡æ¢ä¸ºåŠ¨ç”»banner\r\n  this.animatedBannerLoaded = true;\r\n} catch (e) {\r\n  console.log(\"load animated banner images error\", e);\r\n}\r\n```\r\n\r\nåˆ©ç”¨PromiseåŠ è½½æ‰€æœ‰å›¾ç‰‡èµ„æºï¼Œä¸¤ä¸ªPromiseæ˜¯å› ä¸ºimagesé‡Œé¢ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„\r\n\r\nå¯ä»¥ç”¨è¿™ç§æ–¹æ³•æå‰åŠ è½½å›¾ç‰‡ è¿™æ ·åˆ‡æ¢çš„æ—¶å€™å°±ä¸ä¼šå¾ˆå¡é¡¿ å—¯ å­¦ä¹ äº†ï¼\r\n\r\n### AnimatedBanner\r\n\r\n```javascript\r\nprops: {\r\n  layerConfig: {\r\n    type: Array,\r\n      required: true,\r\n  },\r\n},\r\n```\r\n\r\næ¥æ”¶çˆ¶ç»„ä»¶å¤„ç†å¥½çš„æ•°ç»„æ•°æ®\r\n\r\n```javascript\r\nconst layerConfig = this.layerConfig;\r\nif (!layerConfig.length) {\r\n  this.$emit(\"error\");\r\n}\r\n\r\nconst container = this.$refs[\"container\"];\r\nlet containerHeight = container.clientHeight;\r\nlet containerWidth = container.clientWidth;\r\nlet containerScale = containerHeight / 155;\r\n\r\n// åŠ è½½å›¾ç‰‡èµ„æºç§»åŠ¨åˆ°ç»„ä»¶å¤–éƒ¨ï¼Œ è¿™é‡Œåªè®¾ç½®å›¾ç‰‡å®½é«˜\r\nlayerConfig.forEach((v) =\u003e {\r\n  v.images.forEach((i, index) =\u003e {\r\n    const img = v.images[index].img;\r\n    img.dataset.height = img.height;\r\n    img.dataset.width = img.width;\r\n    img.height =\r\n      img.dataset.height * containerScale * (v.initial.scale || 1);\r\n    img.width = img.dataset.width * containerScale * (v.initial.scale || 1);\r\n  });\r\n});\r\n```\r\n\r\nå¦‚æœæ²¡æœ‰è°ƒç”¨$emitå‘Šè¯‰çˆ¶ç»„ä»¶æ˜¾ç¤ºé™æ€å›¾ç‰‡\r\n\r\nè·å–å®¹å™¨å’Œå®½é«˜ç¼©æ”¾ç­‰å±æ€§ï¼Œå¹¶ä¸”è®¾ç½®çˆ¶ç»„ä»¶è·å–å›¾ç‰‡çš„å®½é«˜ç­‰å±æ€§ å¹¶ä¸”æ ¹æ®ç¼©æ”¾æ¯”ä¾‹è®¡ç®—\r\n\r\n```javascript\r\n// åˆå§‹åŒ–å›¾å±‚\r\nconst layers = layerConfig.map((v) =\u003e {\r\n  const layer = document.createElement(\"div\");\r\n  layer.classList.add(\"layer\");\r\n  container.appendChild(layer);\r\n  return layer;\r\n});\r\n```\r\n\r\nåˆå§‹åŒ–å›¾å±‚åˆ°container\r\n\r\n```javascript\r\n// åˆå§‹çŠ¶æ€\r\nconst iaf = () =\u003e {\r\n  try {\r\n    layers.map((layer, i) =\u003e {\r\n      // console.log(\"layer log\", i, layer);\r\n      const v = layerConfig[i];\r\n      const a = layer.firstChild;\r\n      // console.log(\"a\", a);\r\n      let rotateStr = \"\";\r\n      let translateStr = \"\";\r\n      if (v.initial.rotate) {\r\n        rotateStr = `rotate(${v.initial.rotate}deg)`;\r\n      }\r\n      if (v.initial.translate) {\r\n        const base = v.initial.translate || [0, 0];\r\n        translateStr = `translate(${base[0]}px, ${base[1]}px)`;\r\n      }\r\n      a.style.transform = `${translateStr} ${rotateStr}`;\r\n      if (v.initial.blur) {\r\n        a.style.filter = `blur(${Math.abs(v.initial.blur)}px)`;\r\n      }\r\n    });\r\n  } catch (e) {\r\n    console.error(e);\r\n    this.$emit(\"error\");\r\n  }\r\n};\r\n\r\n// åˆ‡æ¢ä¸‹ä¸€å¸§çš„æ–¹æ³•\r\nconst changeToNextFrame = (layer, images, i) =\u003e {\r\n  setTimeout(() =\u003e {\r\n    const next = i === images.length - 1 ? 0 : i + 1;\r\n    layer.removeChild(layer.firstChild);\r\n    layer.appendChild(images[next].img);\r\n    changeToNextFrame(layer, images, next);\r\n    requestAnimationFrame(af);\r\n  }, images[i].duration);\r\n};\r\n\r\n// åˆå§‹åŒ–å›¾å±‚å†…å›¾ç‰‡å’Œå¸§åŠ¨ç”»\r\nlayerConfig.map((v, i) =\u003e {\r\n  const a = v.images[0].img;\r\n  layers[i].appendChild(a);\r\n  requestAnimationFrame(iaf);\r\n  if (v.images.length \u003e 1 \u0026\u0026 v.loopTime \u003e 0) {\r\n    changeToNextFrame(layers[i], v.images, 0);\r\n  }\r\n});\r\n```\r\n\r\nåˆå§‹åŒ–å›¾å±‚å›¾ç‰‡å’Œä¸€äº›é»˜è®¤æ ·å¼å¹¶ä¸”å¼€å§‹å¸§åŠ¨ç”»\r\n\r\nåˆ©ç”¨å®šæ—¶å™¨loop toggle img åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ç„¶åæ·»åŠ ä¸‹ä¸€å¸§å›¾ç‰‡ç„¶åå†è°ƒç”¨è‡ªå·±\r\n\r\n```javascript\r\ndocument.addEventListener(\"mouseleave\", this.handleMouseLeave);\r\nwindow.addEventListener(\"mousemove\", this.handleMouseMove);\r\nwindow.addEventListener(\"resize\", this.handleResize);\r\n\r\nbeforeDestroy() {\r\n  document.removeEventListener(\"mouseleave\", this.handleMouseLeave);\r\n  window.removeEventListener(\"mousemove\", this.handleMouseMove);\r\n  window.removeEventListener(\"resize\", this.handleResize);\r\n},\r\n```\r\n\r\nç›‘å¬ä¸€äº›äº‹ä»¶\r\n\r\n```javascript\r\nthis.handleMouseMove = (e) =\u003e {\r\n  const offsetY = document.documentElement.scrollTop + e.clientY;\r\n  console.log(\"offsetY\", offsetY, e);\r\n  if (offsetY \u003c containerHeight) {\r\n    if (!entered) {\r\n      entered = true;\r\n      enterX = e.clientX;\r\n    }\r\n    displace = (e.clientX - enterX) / containerWidth;\r\n    cancelAnimationFrame(raf);\r\n    raf = requestAnimationFrame(af);\r\n  } else {\r\n    if (entered) {\r\n      entered = false;\r\n      handleLeave();\r\n    }\r\n  }\r\n};\r\n```\r\n\r\né¼ æ ‡ç»è¿‡å®¹å™¨æ‰§è¡Œaf å…ˆå–æ¶ˆå†ç»§ç»­ï¼Œä¸åœ¨å®¹å™¨å†…è°ƒç”¨ handleLeave\r\n\r\n```javascript\r\nenterX = e.clientX;\r\ndisplace = (e.clientX - enterX) / containerWidth;\r\n```\r\n\r\nè¿™ä¸¤ä¸ªçš„å«ä¹‰å…¶å®æˆ‘è¿˜æ²¡å¤ªç†è§£ åç»­éœ€è¦ç”¨ displace å‚ä¸è®¡ç®— åº”è¯¥å°±æ˜¯ç”¨æ¥åˆ¤æ–­å¾€å·¦è¿˜æ˜¯å³è¾¹çš„\r\n\r\n```javascript\r\n// æ ¹æ®é¼ æ ‡ä½ç½®æ”¹å˜çŠ¶æ€\r\nconst af = (t) =\u003e {\r\n  try {\r\n    layers.map((layer, i) =\u003e {\r\n      const v = layerConfig[i];\r\n      const a = layer.firstChild;\r\n      if (!v.offset || !a) {\r\n        return;\r\n      }\r\n\r\n      const baseRotate = v.initial.rotate || 0;\r\n      const baseTranslate = v.initial.trannslate || [0, 0];\r\n      let scaleStr = ``;\r\n      let rotateStr = `rotate(${v.initial.rotate || 0}deg)`;\r\n      let translateStr = `translate(${baseTranslate[0]}px, ${baseTranslate[1]}px)`;\r\n\r\n      console.log(\r\n        \"rotateStr translateStr\",\r\n        rotateStr,\r\n        translateStr,\r\n        v.offset\r\n      );\r\n\r\n      if (v.offset.scale) {\r\n        const itp =\r\n              v.offsetCurve \u0026\u0026 v.offsetCurve.scale\r\n        ? curveParameterToFunc(v.offsetCurve.scale)\r\n        : (x) =\u003e x;\r\n        const offset = v.offset.scale * itp(displace);\r\n        scaleStr = `scale(${1 + offset})`;\r\n      }\r\n      if (v.offset.rotate) {\r\n        const itp =\r\n              v.offsetCurve \u0026\u0026 v.offsetCurve.rotate\r\n        ? curveParameterToFunc(v.offsetCurve.rotate)\r\n        : (x) =\u003e x;\r\n        const offset = v.offset.rotate * itp(displace);\r\n        rotateStr = `rotate(${baseRotate + offset}deg)`;\r\n      }\r\n      if (v.offset.translate) {\r\n        const itp =\r\n              v.offsetCurve \u0026\u0026 v.offsetCurve.translate\r\n        ? curveParameterToFunc(v.offsetCurve.translate)\r\n        : (x) =\u003e x;\r\n        const offset = v.offset.translate.map((v) =\u003e itp(displace) * v);\r\n        const translate = baseTranslate.map(\r\n          (x, i) =\u003e\r\n          (x + offset[i]) * containerScale * (v.initial.scale || 1)\r\n        );\r\n        translateStr = `translate(${translate[0]}px, ${translate[1]}px)`;\r\n      }\r\n      a.style.transform = `${scaleStr} ${translateStr} ${rotateStr}`;\r\n      if (v.offset.blur) {\r\n        const itp =\r\n              v.offsetCurve \u0026\u0026 v.offsetCurve.blur\r\n        ? curveParameterToFunc(v.offsetCurve.blur)\r\n        : (x) =\u003e x;\r\n        const blurOffset = itp(displace) * v.offset.blur;\r\n        a.style.filter = `blur(${Math.abs(\r\n          (v.initial.blur || 0) + blurOffset\r\n        )}px)`;\r\n      }\r\n    });\r\n  } catch (e) {\r\n    console.error(e);\r\n    this.$emit(\"error\");\r\n  }\r\n};\r\n```\r\n\r\nå…³é”®ä»£ç åœ¨è¿™é‡Œ...\r\n\r\n1. åˆ¤æ–­æœ‰æ²¡æœ‰å…ƒç´ \r\n\r\n2. è·å–ä¸€äº›åˆå§‹çš„style\r\n\r\n3. ç„¶ååˆ¤æ–­æœ‰æ²¡æœ‰offset scale rotate translate blur ç„¶åæ‰§è¡ŒåŠ¨ç”»\r\n\r\n4. åˆ¤æ–­æœ‰æ²¡æœ‰ offset curve å¦‚æœæœ‰ç”¨ cubicBezier æ²¡æœ‰å°±ç”¨é»˜è®¤å‚æ•°\r\n\r\n5. å¾€å³è¾¹ x2 \u003e x1 / width æ­£æ•°\r\n\r\n   1. Scale é»˜è®¤æ˜¯ 1\r\n\r\n      ```javascript\r\n      const offset = v.offset.scale * itp(displace);\r\n      scaleStr = `scale(${1 + offset})`;\r\n      ```\r\n\r\n   2. Rotate æ ¹æ®ä¸Šé¢å®šä¹‰çš„é»˜è®¤å‚æ•°ç„¶ååŠ ä¸Šæ–°è§’åº¦\r\n\r\n      ```javascript\r\n      const offset = v.offset.rotate * itp(displace);\r\n      rotateStr = `rotate(${baseRotate + offset}deg)`;\r\n      ```\r\n\r\n   3. Translate æ ¹æ®æ¯”ä¾‹è®¡ç®—\r\n\r\n      ```javascript\r\n      const offset = v.offset.translate.map((v) =\u003e itp(displace) * v);\r\n      const translate = baseTranslate.map(\r\n        (x, i) =\u003e\r\n        (x + offset[i]) * containerScale * (v.initial.scale || 1)\r\n      );\r\n      translateStr = `translate(${translate[0]}px, ${translate[1]}px)`;\r\n      ```\r\n\r\n      å› ä¸ºæ˜¯ä¸ªarræ‰€ä»¥map loopï¼Œåé¢çš„ * å®¹å™¨æ¯”ä¾‹ * åˆå§‹åŒ–scale åº”è¯¥æ˜¯é€‚é…ç¼©æ”¾çš„æ¯”ä¾‹ç„¶åå˜åŒ–ä½ç½®\r\n\r\n      ```javascript\r\n      a.style.transform = `${scaleStr} ${translateStr} ${rotateStr}`;\r\n      ```\r\n\r\n      æœ€åè®¾ç½®å±æ€§\r\n\r\n   4. blur åˆå§‹çš„blur + å˜åŒ–åçš„blur\r\n\r\n      ```javascript\r\n      const blurOffset = itp(displace) * v.offset.blur;\r\n      a.style.filter = `blur(${Math.abs(\r\n        (v.initial.blur || 0) + blurOffset\r\n      )}px)`;\r\n      ```\r\n\r\n```javascript\r\nconst handleLeave = () =\u003e {\r\n  const now = performance.now();\r\n  const timeout = 200;\r\n  const tempDisplace = displace;\r\n  cancelAnimationFrame(raf);\r\n  const leaveAF = (t) =\u003e {\r\n    if (t - now \u003c timeout) {\r\n      displace = tempDisplace * (1 - (t - now) / 200);\r\n      af(t);\r\n      requestAnimationFrame(leaveAF);\r\n    } else {\r\n      displace = 0;\r\n      af(t);\r\n    }\r\n  };\r\n  raf = requestAnimationFrame(leaveAF);\r\n};\r\n```\r\n\r\né¼ æ ‡ç¦»å¼€å åœ¨200timeå†…displaceä¼šé€æ¸å˜å°æˆ–æ‰©å¤§ å–å†³äºæ­£æ•°è¿˜æ˜¯è´Ÿæ•° è¶…è¿‡æ—¶é—´åä¼šè®¾ç½®ä¸º 0 ç„¶åè°ƒç”¨åŠ¨ç”»æ¢å¤é»˜è®¤å‚æ•°\r\n\r\n```javascript\r\nthis.handleResize = () =\u003e {\r\n  containerHeight = container.clientHeight;\r\n  containerWidth = container.clientWidth;\r\n  containerScale = containerHeight / 155;\r\n  layerConfig.forEach((lc) =\u003e {\r\n    lc.images.forEach((i) =\u003e {\r\n      const img = i.img;\r\n      img.height =\r\n        img.dataset.height * containerScale * (lc.initial.scale || 1);\r\n      img.width =\r\n        img.dataset.width * containerScale * (lc.initial.scale || 1);\r\n    });\r\n  });\r\n  cancelAnimationFrame(raf);\r\n  raf = requestAnimationFrame((t) =\u003e {\r\n    af(t);\r\n  });\r\n};\r\n```\r\n\r\nÂ è®¾ç½®å®¹å™¨çš„æ ·å¼å‚æ•°ç„¶åå–æ¶ˆåŠ¨ç”»å†å¼€å§‹åŠ¨ç”»èµ‹å€¼ç»™raf\r\n\r\n","comments":{"nodes":[]},"reactionGroups":[{"content":"THUMBS_UP","reactors":{"totalCount":0}},{"content":"THUMBS_DOWN","reactors":{"totalCount":0}},{"content":"LAUGH","reactors":{"totalCount":0}},{"content":"HOORAY","reactors":{"totalCount":0}},{"content":"CONFUSED","reactors":{"totalCount":0}},{"content":"HEART","reactors":{"totalCount":0}},{"content":"ROCKET","reactors":{"totalCount":0}},{"content":"EYES","reactors":{"totalCount":0}}],"author":{"login":"xiaotiandada","url":"https://github.com/xiaotiandada","avatarUrl":"https://avatars.githubusercontent.com/u/24250627?u=51a93e07957381123eb9fbdd6407de36033b578d\u0026v=4"},"html":"\u003cp\u003e 2020-11-16 21:52:56\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://i.imgur.com/2BWZJjY.jpg?1\" alt=\"åŠ¨ç”»æ•ˆæœ\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.bilibili.com/\"\u003ehttps://www.bilibili.com/\u003c/a\u003e åé¢å¯èƒ½ä¼šè¢«æ›´æ–°æ‰\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eÂ ä¸ºä»€ä¹ˆå«ä¸€ï¼Ÿ è¯´ä¸èƒ½è¿˜æœ‰åˆ«çš„å¥½ç©çš„åŠ¨ç”»å­¦ä¹ ï¼\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c!-- more --\u003e\n\n\u003ciframe src=\"https://codesandbox.io/embed/bilibili-bannner-w49d7?fontsize=14\u0026hidenavigation=1\u0026theme=dark\u0026view=preview\"\n     style=\"width:100%; height:200px; border:0; border-radius: 4px; overflow:hidden;\"\n     title=\"bilibili bannner\"\n     allow=\"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking\"\n     sandbox=\"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts\"\n   \u003e\u003c/iframe\u003e\n\n\u003cp\u003eä¸»è¦ä¸¤ä¸ªç»„ä»¶å®Œæˆï¼Œä»£ç æˆ‘ä¹Ÿæ˜¯å¤åˆ¶bç«™å¤§ä½¬çš„ğŸ‘ ç„¶åè‡ªå·±ç†è§£ç†è§£æ€è·¯\u003c/p\u003e\n\u003ch3 id=\"bannervue\"\u003eBanner.vue\u003c/h3\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e  \u003cspan class=\"token literal-property property\"\u003ecomputed\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003elocs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token comment\"\u003e//...\u003c/span\u003e\n        \u003cspan class=\"token literal-property property\"\u003epic\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\n          \u003cspan class=\"token string\"\u003e\"http://i0.hdslb.com/bfs/archive/0b7eef054547750e6bfeff6f36c83e83d2a058fb.png\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token literal-property property\"\u003elitpic\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\n          \u003cspan class=\"token string\"\u003e\"http://i0.hdslb.com/bfs/archive/622017dd4b0140432962d3ce0c6db99d77d2e937.png\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                \u003cspan class=\"token comment\"\u003e//...\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003ebannerImg\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elocs \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elocs\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003epic\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003etrim\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003elogoImg\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elocs \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elocs\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elitpic\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003etrim\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eè¿”å›ä¸€å¼ é™æ­¢çš„é¡µé¢ï¼Œåœ¨æ²¡æœ‰åŠ è½½å®Œæˆæˆ–è€…ä¸æ”¯æŒçš„æ—¶å€™æ˜¾ç¤º\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// è§£ææ•°æ® æå‰å®šä¹‰å¥½çš„å…·ä½“çœ‹ä»£ç \u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elayerConfig \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token constant\"\u003eJSON\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eparse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'[...]'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eè§£æbanneræ•°æ®\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// åªæœ‰åœ¨å¯ç”¨äº†åŠ¨ç”»bannerçš„é…ç½®ï¼Œä¸”æµè§ˆå™¨æ”¯æŒcss filteræ—¶æ‰åŠ è½½åŠ¨ç”»bannerçš„å›¾ç‰‡èµ„æº\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eanimatedBannerSupport \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003etypeof\u003c/span\u003e \u003cspan class=\"token constant\"\u003eCSS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!==\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"undefined\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eCSS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esupports \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eCSS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esupports\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"filter: blur(1px)\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eæŸ¥çœ‹æ˜¯å¦æ”¯æŒä¸€äº›éœ€è¦çš„æ¡ä»¶\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// æ ¹æ®æ¯å¸§æ—¶é•¿è®¡ç®—å¾ªç¯æ—¶é—´\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elayerConfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ev\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eloopTime \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ereduce\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ep\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e c\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e p \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ec\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eduration \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eç»Ÿè®¡æ‰€æœ‰Time åˆ©ç”¨ Reduce ç´¯è®¡\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// åŠ è½½æ‰€æœ‰å›¾ç‰‡èµ„æº\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e Promise\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eall\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elayerConfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ev\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"v\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e Promise\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eall\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n        v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ei\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e index\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e img \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"img\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n          img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esrc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e i\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esrc\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n          \u003cspan class=\"token keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eresolve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eimg\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eonload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e resolve\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n          v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eindex\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimg \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e img\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"this.layerConfig\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elayerConfig\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// åˆ‡æ¢ä¸ºåŠ¨ç”»banner\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eanimatedBannerLoaded \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"load animated banner images error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eåˆ©ç”¨PromiseåŠ è½½æ‰€æœ‰å›¾ç‰‡èµ„æºï¼Œä¸¤ä¸ªPromiseæ˜¯å› ä¸ºimagesé‡Œé¢ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„\u003c/p\u003e\n\u003cp\u003eå¯ä»¥ç”¨è¿™ç§æ–¹æ³•æå‰åŠ è½½å›¾ç‰‡ è¿™æ ·åˆ‡æ¢çš„æ—¶å€™å°±ä¸ä¼šå¾ˆå¡é¡¿ å—¯ å­¦ä¹ äº†ï¼\u003c/p\u003e\n\u003ch3 id=\"animatedbanner\"\u003eAnimatedBanner\u003c/h3\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token literal-property property\"\u003eprops\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token literal-property property\"\u003elayerConfig\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token literal-property property\"\u003etype\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e Array\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token literal-property property\"\u003erequired\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eæ¥æ”¶çˆ¶ç»„ä»¶å¤„ç†å¥½çš„æ•°ç»„æ•°æ®\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e layerConfig \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elayerConfig\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003elayerConfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elength\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003e$emit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e container \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e$refs\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"container\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e containerHeight \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e container\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclientHeight\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e containerWidth \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e container\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclientWidth\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e containerScale \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e containerHeight \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e \u003cspan class=\"token number\"\u003e155\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// åŠ è½½å›¾ç‰‡èµ„æºç§»åŠ¨åˆ°ç»„ä»¶å¤–éƒ¨ï¼Œ è¿™é‡Œåªè®¾ç½®å›¾ç‰‡å®½é«˜\u003c/span\u003e\nlayerConfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ev\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ei\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e index\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e img \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eindex\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimg\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edataset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edataset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n      img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edataset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e containerScale \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edataset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e containerScale \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eå¦‚æœæ²¡æœ‰è°ƒç”¨$emitå‘Šè¯‰çˆ¶ç»„ä»¶æ˜¾ç¤ºé™æ€å›¾ç‰‡\u003c/p\u003e\n\u003cp\u003eè·å–å®¹å™¨å’Œå®½é«˜ç¼©æ”¾ç­‰å±æ€§ï¼Œå¹¶ä¸”è®¾ç½®çˆ¶ç»„ä»¶è·å–å›¾ç‰‡çš„å®½é«˜ç­‰å±æ€§ å¹¶ä¸”æ ¹æ®ç¼©æ”¾æ¯”ä¾‹è®¡ç®—\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// åˆå§‹åŒ–å›¾å±‚\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e layers \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e layerConfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ev\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e layer \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"div\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  layer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclassList\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eadd\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"layer\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  container\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eappendChild\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elayer\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e layer\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eåˆå§‹åŒ–å›¾å±‚åˆ°container\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// åˆå§‹çŠ¶æ€\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eiaf\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    layers\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003elayer\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e// console.log(\"layer log\", i, layer);\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e v \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e layerConfig\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e a \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e layer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstChild\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e// console.log(\"a\", a);\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e rotateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e translateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erotate\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        rotateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003erotate(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erotate\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003edeg)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e base \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etranslate \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        translateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003etranslate(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ebase\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx, \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ebase\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n      a\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estyle\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etransform \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etranslateStr\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003erotateStr\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eblur\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        a\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estyle\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efilter \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eblur(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eMath\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eabs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eblur\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003e$emit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// åˆ‡æ¢ä¸‹ä¸€å¸§çš„æ–¹æ³•\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003echangeToNextFrame\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003elayer\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e images\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003esetTimeout\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e next \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e images\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elength \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    layer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eremoveChild\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elayer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstChild\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    layer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eappendChild\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003enext\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimg\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003echangeToNextFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elayer\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e images\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e next\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003erequestAnimationFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaf\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e images\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eduration\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// åˆå§‹åŒ–å›¾å±‚å†…å›¾ç‰‡å’Œå¸§åŠ¨ç”»\u003c/span\u003e\nlayerConfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ev\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e a \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimg\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  layers\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eappendChild\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ea\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003erequestAnimationFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eiaf\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elength \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eloopTime \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003echangeToNextFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elayers\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eåˆå§‹åŒ–å›¾å±‚å›¾ç‰‡å’Œä¸€äº›é»˜è®¤æ ·å¼å¹¶ä¸”å¼€å§‹å¸§åŠ¨ç”»\u003c/p\u003e\n\u003cp\u003eåˆ©ç”¨å®šæ—¶å™¨loop toggle img åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ç„¶åæ·»åŠ ä¸‹ä¸€å¸§å›¾ç‰‡ç„¶åå†è°ƒç”¨è‡ªå·±\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mouseleave\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehandleMouseLeave\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nwindow\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mousemove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehandleMouseMove\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nwindow\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eaddEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"resize\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehandleResize\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token function\"\u003ebeforeDestroy\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eremoveEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mouseleave\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehandleMouseLeave\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  window\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eremoveEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mousemove\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehandleMouseMove\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  window\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eremoveEventListener\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"resize\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehandleResize\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eç›‘å¬ä¸€äº›äº‹ä»¶\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function-variable function\"\u003ehandleMouseMove\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e offsetY \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edocumentElement\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escrollTop \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclientY\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"offsetY\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e offsetY\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eoffsetY \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e containerHeight\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003eentered\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      entered \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      enterX \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclientX\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    displace \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclientX \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e enterX\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e containerWidth\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003ecancelAnimationFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eraf\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    raf \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequestAnimationFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaf\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eentered\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      entered \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token function\"\u003ehandleLeave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eé¼ æ ‡ç»è¿‡å®¹å™¨æ‰§è¡Œaf å…ˆå–æ¶ˆå†ç»§ç»­ï¼Œä¸åœ¨å®¹å™¨å†…è°ƒç”¨ handleLeave\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003eenterX \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclientX\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\ndisplace \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclientX \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e enterX\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e containerWidth\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eè¿™ä¸¤ä¸ªçš„å«ä¹‰å…¶å®æˆ‘è¿˜æ²¡å¤ªç†è§£ åç»­éœ€è¦ç”¨ displace å‚ä¸è®¡ç®— åº”è¯¥å°±æ˜¯ç”¨æ¥åˆ¤æ–­å¾€å·¦è¿˜æ˜¯å³è¾¹çš„\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// æ ¹æ®é¼ æ ‡ä½ç½®æ”¹å˜çŠ¶æ€\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eaf\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003et\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    layers\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003elayer\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e v \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e layerConfig\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e a \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e layer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstChild\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token operator\"\u003e!\u003c/span\u003ea\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e baseRotate \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erotate \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e baseTranslate \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etrannslate \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e scaleStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e rotateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003erotate(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erotate \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003edeg)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e translateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003etranslate(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ebaseTranslate\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx, \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ebaseTranslate\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n      console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"token string\"\u003e\"rotateStr translateStr\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        rotateStr\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        translateStr\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\n      \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e itp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n              v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale\n        \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e \u003cspan class=\"token function\"\u003ecurveParameterToFunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e offset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token function\"\u003eitp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edisplace\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        scaleStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003escale(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e offset\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erotate\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e itp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n              v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erotate\n        \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e \u003cspan class=\"token function\"\u003ecurveParameterToFunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erotate\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e offset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erotate \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token function\"\u003eitp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edisplace\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        rotateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003erotate(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ebaseRotate \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e offset\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003edeg)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e itp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n              v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etranslate\n        \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e \u003cspan class=\"token function\"\u003ecurveParameterToFunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e offset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ev\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003eitp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edisplace\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e translate \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e baseTranslate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ex\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ex \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e offset\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e containerScale \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        translateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003etranslate(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx, \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n      a\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estyle\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etransform \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003escaleStr\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etranslateStr\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003erotateStr\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eblur\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e itp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n              v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eblur\n        \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e \u003cspan class=\"token function\"\u003ecurveParameterToFunc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffsetCurve\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eblur\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e blurOffset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eitp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edisplace\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eblur\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        a\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estyle\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efilter \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eblur(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eMath\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eabs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n          \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eblur \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e blurOffset\n        \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    console\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003e$emit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"error\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eå…³é”®ä»£ç åœ¨è¿™é‡Œ...\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eåˆ¤æ–­æœ‰æ²¡æœ‰å…ƒç´ \u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eè·å–ä¸€äº›åˆå§‹çš„style\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eç„¶ååˆ¤æ–­æœ‰æ²¡æœ‰offset scale rotate translate blur ç„¶åæ‰§è¡ŒåŠ¨ç”»\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eåˆ¤æ–­æœ‰æ²¡æœ‰ offset curve å¦‚æœæœ‰ç”¨ cubicBezier æ²¡æœ‰å°±ç”¨é»˜è®¤å‚æ•°\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eå¾€å³è¾¹ x2 \u0026gt; x1 / width æ­£æ•°\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003eScale é»˜è®¤æ˜¯ 1\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e offset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token function\"\u003eitp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edisplace\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nscaleStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003escale(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e offset\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eRotate æ ¹æ®ä¸Šé¢å®šä¹‰çš„é»˜è®¤å‚æ•°ç„¶ååŠ ä¸Šæ–°è§’åº¦\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e offset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erotate \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token function\"\u003eitp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edisplace\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nrotateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003erotate(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ebaseRotate \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e offset\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003edeg)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eTranslate æ ¹æ®æ¯”ä¾‹è®¡ç®—\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e offset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ev\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003eitp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edisplace\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e translate \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e baseTranslate\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ex\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ex \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e offset\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e containerScale \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\ntranslateStr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003etranslate(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx, \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eå› ä¸ºæ˜¯ä¸ªarræ‰€ä»¥map loopï¼Œåé¢çš„ * å®¹å™¨æ¯”ä¾‹ * åˆå§‹åŒ–scale åº”è¯¥æ˜¯é€‚é…ç¼©æ”¾çš„æ¯”ä¾‹ç„¶åå˜åŒ–ä½ç½®\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003ea\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estyle\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etransform \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003escaleStr\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003etranslateStr\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003erotateStr\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eæœ€åè®¾ç½®å±æ€§\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eblur åˆå§‹çš„blur + å˜åŒ–åçš„blur\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e blurOffset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eitp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edisplace\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e v\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eoffset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eblur\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\na\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estyle\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efilter \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eblur(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eMath\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eabs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ev\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eblur \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e blurOffset\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003epx)\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003ehandleLeave\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e now \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e performance\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003enow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e timeout \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e200\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e tempDisplace \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e displace\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003ecancelAnimationFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eraf\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eleaveAF\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003et\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003et \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e now \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e timeout\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      displace \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e tempDisplace \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003et \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e now\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e \u003cspan class=\"token number\"\u003e200\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token function\"\u003eaf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003et\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token function\"\u003erequestAnimationFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eleaveAF\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      displace \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token function\"\u003eaf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003et\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  raf \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequestAnimationFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eleaveAF\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eé¼ æ ‡ç¦»å¼€å åœ¨200timeå†…displaceä¼šé€æ¸å˜å°æˆ–æ‰©å¤§ å–å†³äºæ­£æ•°è¿˜æ˜¯è´Ÿæ•° è¶…è¿‡æ—¶é—´åä¼šè®¾ç½®ä¸º 0 ç„¶åè°ƒç”¨åŠ¨ç”»æ¢å¤é»˜è®¤å‚æ•°\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function-variable function\"\u003ehandleResize\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  containerHeight \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e container\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclientHeight\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  containerWidth \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e container\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclientWidth\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  containerScale \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e containerHeight \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e \u003cspan class=\"token number\"\u003e155\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  layerConfig\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003elc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    lc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimages\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ei\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e img \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e i\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eimg\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n        img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edataset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eheight \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e containerScale \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n        img\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edataset\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewidth \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e containerScale \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elc\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einitial\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escale \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003ecancelAnimationFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eraf\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  raf \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003erequestAnimationFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003et\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eaf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003et\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eÂ è®¾ç½®å®¹å™¨çš„æ ·å¼å‚æ•°ç„¶åå–æ¶ˆåŠ¨ç”»å†å¼€å§‹åŠ¨ç”»èµ‹å€¼ç»™raf\u003c/p\u003e\n","attributes":{}},"themeConfig":{"title":"Blog(issues)","links":[{"title":"GitHub","url":"https://github.com/xiaotiandada/blog"},{"title":"Twitter","url":"https://twitter.com/XiaoTianIsMe"}]}},"__N_SSG":true},"page":"/[...path]","query":{"path":["MDU6SXNzdWU3ODg3NTE4NDk="]},"buildId":"YPEk3V-eoVeml18YoUSCM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>